<<<<<<< HEAD
・ｿ;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｷ繝ｧ繝・・繝｡繝九Η繝ｼ縺ｮ陦ｨ遉ｺ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@SHOW_SHOP
CALL VERSION_UP

DRAWLINE
PRINTFORML {FLAG:・ｰ・・1}・・{FLAG:・ｼ・・1}・ｼ・ｸ (%GET_TIME()%) %GET_SEASON()% %GET_DAY()%・肥攵 縲・ｨ寬ｸ・假ｼ・CALLNAME:1%
SIF TARGET >= 0
	PRINTFORML %CALLNAME:MASTER%(・・・ｼ %CALLNAME:TARGET%・ｴ(・) ・ｰ・川､・SIF ASSI:1 >= 0
	PRINTFORML ・溢｡ｰ・假ｼ托ｼ・CALLNAME:(ASSI:1)%・噂@ ASSI:2 >= 0 ? ・溢｡ｰ・假ｼ抵ｼ・CALLNAME:(ASSI:2)%・・# \@
HTML_PRINT HTML_BASE("・ｴ・･", MASTER, 0, 16) + HTML_BASE("・ｰ・･", MASTER, 1, 16)
SIF TARGET >= 0
	PRINTFORML (%CALLNAME%・・・壱･縲{CFLAG:・壱･})
[SKIPSTART]
隕√ｉ縺ｪ縺・→諤昴≧縺ｮ縺ｧ繧ｳ繝｡繝ｳ繝医い繧ｦ繝医＠縺ｦ縺翫″縺ｾ縺僉/L
IF TARGET >= 0
	PRINTFORML 縲川攪・ｴ・・test甯舌代(%CALLNAME%・・%CALLNAME:MASTER%・川攪 ・們｡ｴ・・ｼ嘴CFLAG:・們｡ｴ・м縲%CALLNAME:MASTER%・・%CALLNAME:(FLAG:・ｼ・ｸ・・%・､・専ｲ誤｡懍攪 ・們｡ｴ・・ｼ嘴CFLAG:MASTER:・們｡ｴ・м)
	PRINTL 縲・｡・ｳ・ｴ ・駆捩 ・・懍乱・懍攪 ・們ｹ俯･ｼ, ・ｨ寬ｸ・們攪 ・ｴ・・ｷ・ｼ・ｸ・ｵ・・・ｱ・・ 﨑 ・・・溢愍・ｴ ・・被復 嵓誤溢擽 ・ｩ・ｨ・・・呷流
	PRINTL 縲・､・・・ｱ・・・ｴ・﨑們共 ・・・溢愍・ｴ(・・ ・､嵂餓桿・壱共. ・罷畠 ・・ｸｰ・ｱ・・・ｬ・ｩ﨑 ・溢菩攪 ・廷桿・壱共.
ENDIF
[SKIPEND]
DRAWLINE
;・・宣幕蟋・;OriginalString : (HTMLAUTOBUTTON("[100] - ・ｰ・川攪 ・懋ｰ・擽・､", "100", "・・舌ｒ髢句ｧ九＠縺ｾ縺・, , , TARGET >= 0, 
;CALL HTMLPRINTL(HTMLAUTOBUTTON("[100] - 隱ｿ謨吶・譎る俣縺梧擂縺・, "100", "隱ｿ謨吶ｒ髢句ｧ九＠縺ｾ縺・, , , TARGET >= 0, 
;"[---] - 隱ｿ謨呵・ｒ豎ｺ繧√※縺上□縺輔＞", "隱ｿ謨吶ｒ髢句ｧ九☆繧狗ぜ縺ｫ縺ｯ縲∬ｪｿ謨呵・ｒ豎ｺ螳壹☆繧句ｿ・ｦ√′縺ゅｊ縺ｾ縺・, 0xA0A0A0))
{
CALL HTMLPRINTL(HTMLAUTOBUTTON("[100] - ・ｰ・川攪 ・懋ｰ・擽・､", "100", "・・尖･ｼ ・懍亨﨑ｩ・壱共", , , TARGET >= 0, 
	"[---] - ・・川梵繧呈ｱｺ繧√※縺上□縺輔＞", "・・舌ｒ髢句ｧ九☆繧狗ぜ縺ｫ縺ｯ縲・｣・川梵繧呈ｱｺ螳壹☆繧駈符・斐′縺ゅｊ縺ｾ縺・, 0xA0A0A0))
}
;閭ｽ蜉幄｡ｨ遉ｺ
;OriginalString : (HTMLBUTTON("[101] - ・･・･・・岺懍亨", "101", "・・川梵縺ｨ・・尖劇・√・蜷・ｨｮ・ｽ嵭們ｹ倡ｭ峨ｒ遒ｺ隱阪＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[101] - ・･・･・・岺懍亨", "101", "・・川梵(・)・ｼ・・尖劇・・攪 ・・｢・ｲｽ嵭們ｹ俯導・・嶹菩攤﨑ｩ・壱共"))
;・壱･豸郁ｲｻ
SIF TARGET >= 0
;OriginalString : (HTMLBUTTON("[102] - ・壱･・・・誤ｹ・復・､", "102", "・壱･繧剃ｽｿ縺｣縺ｦ繧｢繧､繝・Β繧・・蜉帷ｭ峨・・ｨ・昴∵眠縺溘↑・・川梵縺ｮ霑ｽ蜉繧定｡後＞縺ｾ縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[102] - ・壱･・・・誤ｹ・復・､", "102", "・壱･・ｼ ・ｬ・ｩ﨑ｴ ・・擽奛懍擽・・・･・･・ｱ・們ｷｨ・・ ・壱｡懍垓・・川梵・・・緋ｰ・ｼ ・､・懦鮒・壱共"))
;・・川梵蛻・ｊ譖ｿ縺・SIF CHARANUM > 2
;OriginalString : (HTMLBUTTON("[110] - ・・川梵/・ｰ・俯･ｼ ・・ｽ﨑罹共", "110", "迴ｾ蝨ｨ縺ｮ・・川梵/・ｰ・倥ｒ莉悶・・・川梵縺ｫ螟画峩縺励∪縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[110] - ・・川梵/・ｰ・俯･ｼ ・・ｽ﨑罹共", "110", "嶸・椪・們｣・川梵/・ｰ・俯･ｼ ・､・ｸ・・川梵・・・・ｽ﨑ｩ・壱共"))
;・們メ ・､・・SIF TARGET > 0
;OriginalString : (HTMLBUTTON("[155] - ・們メ ・､・・, "155", "・・川梵縺ｨ・・尖劇・√・・們メ繧定ｨｭ螳壹＠縺ｾ縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[155] - ・們メ ・､・・, "155", "・・川梵(・)・ｼ・・尖劇・・・・們メ・ｼ ・､・倣鮒・壱共"))
;繝・・繧ｿ繝吶・繧ｹ
;OriginalString : (HTMLBUTTON("[177] - ・ｰ・ｴ奓ｰ・・ｴ・､ ・ｴ・ｰ", "177", "蜷・ｨｮ・・舌ョ繝ｼ繧ｿ繧堤｢ｺ隱阪＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[177] - ・ｰ・ｴ奓ｰ・・ｴ・､ ・ｴ・ｰ", "177", "・・｢・｣・尖魂・ｴ奓ｰ・ｼ 嶹菩攤﨑ｩ・壱共"))
;繧ｳ繝ｳ繝輔ぅ繧ｰ
;OriginalString : (HTMLBUTTON("[178] - ・ｬ・ｱ", "178", "繧ｲ繝ｼ繝縺ｮ險ｭ螳壹ｒ陦後＞縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[178] - ・ｬ・ｱ", "178", "・護桷・・・､・菩揆 ・､・懦鮒・壱共"))
;・ｸ・ｴ・・;OriginalString : (HTMLBUTTON("[200] - ・ｸ・ｴ・・, "200", "迴ｾ蝨ｨ縺ｮ繝・・繧ｿ繧剃ｿ晏ｭ倥＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[200] - ・ｸ・ｴ・・, "200", "嶸・椪・・・ｰ・ｴ奓ｰ・ｼ ・ｴ・ｴ﨑ｩ・壱共"))
;・罹糖
;OriginalString : (HTMLBUTTON("[300] - ・罹糖", "300", "菫晏ｭ倆毎・､繝・・繧ｿ繧定ｪｭ縺ｿ霎ｼ縺ｿ縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[300] - ・罹糖", "300", "・ｴ・ｴ嵂壱共・ｰ・ｴ奓ｰ・ｼ ・ｽ・ｴ・､・・笈・､"))

;Emuera・罷ｲ・ｷｸ・ｨ・懆ｵｷ蜍墓凾
[IF_DEBUG]
{
;OriginalString : (HTMLBUTTON("[777] - ・罷ｲ・ｷｸ・ｨ・・ + (FLAG:・罷ｲ・ｷｸ ? "・ｼ ・・｣・ # ""), "777", 
	CALL HTMLPRINTL(HTMLBUTTON("[777] - ・罷ｲ・ｷｸ・ｨ・・ + (FLAG:・罷ｲ・ｷｸ ? "・ｼ ・・｣・ # ""), "777", 
		FLAG:・罷ｲ・ｷｸ ? "奝ｵ・・剩・ｴ・ｼ・・・護符・瀧笈・､" # "・・・・罷ｲ・ｷｸ・ｨ・罹･ｼ ・ｬ・ｩ﨑ｩ・壱共"))
}
	IF FLAG:・罷ｲ・ｷｸ
		PRINTFORML \n--・罷ｲ・ｷｸ ・､・俯糖・・・・失﨑俾ｲ・・・勦・・・緋ｿ ・・・醐⊂)・・・・紛・・・誤ｬｸ・・ ・誤豆・溢愍・・・\n・ｴ﨑們攪 ・､・俯糖・・・倆復 ・ｴ・・捩 ・呷梠 ・ｴ・･・ｸ・・﨑ｩ・壱共--\n
		;・壱･蠅怜刈
		SIF TARGET >= 0
;OriginalString : (HTMLBUTTON("[778] - ・壱･蠅怜刈", "778", "・・川梵縺ｮ・壱･繧貞｢励ｄ縺励∪縺・))
			CALL HTMLPRINTL(HTMLBUTTON("[778] - ・壱･・晝ｰ", "778", "・・川梵・ｸ・壱･・ｼ ・俯ｦｽ・壱共"))
		;霆｢逕溘・蜆蠑・;OriginalString : (HTMLBUTTON("[779] - 霆｢逕溘・蜆蠑・, "779", "嵓誤溢擽繝､繝ｼ繧ｭ繝｣繝ｩ縺ｮ蜀崎ｨｭ螳夂判髱｢縺ｸ騾ｲ縺ｿ縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[779] - ・・・・・・們享", "779", "嵓誤溢擽・ｼ・尖攵・・・ｬ・､・・嶹罷ｩｴ・ｼ・・・們符・瀧笈・､"))
		;嵓誤椈・ｸ繝√ぉ繝・け
;OriginalString : (HTMLBUTTON("[780] - 嵓誤椈・ｸ繝√ぉ繝・け", "780", "CFLAG縺ｨFLAG縺ｮ迥ｶ豕√ｒ遒ｺ隱阪＠縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[780] - 嵓誤椈・ｸ・ｴ增ｬ", "780", "CFLAG(・)・ｼFLAG・・・・勦・・嶹菩攤﨑ｩ・壱共"))
		;・､奝・ｨ・・;OriginalString : (HTMLBUTTON("[781] - ・､奝・ｨ・・, "781", "・・尖劇・√・嵂雅徐繧定・蜍輔〒陦後≧・ｨ・懊・險ｭ螳夂判髱｢繧貞他縺ｳ蜃ｺ縺励∪縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[781] - ・､奝・ｨ・・, "781", "・・尖劇・・・嵂雅徐・ｼ ・尖徐・ｼ・・・､・懦復・､・ｨ・懍攪 ・､・・嶹罷ｩｴ・・嶸ｸ・懦鮒・壱共"))
		;邏雉ｪ・ｴ・慕｢ｺ隱・;OriginalString : (HTMLBUTTON("[782] - 邏雉ｪ・ｴ・慕｢ｺ隱・, "782", "蜷・く繝｣繝ｩ縺ｮ繧ｳ繝槭Φ繝餓│夋晝ｲｽ嵂･繧堤｢ｺ隱阪＠縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[782] - ・護ｧ壱ｳｴ・倣剳・ｸ", "782", "・・・尖ｦｭ奓ｰ・・・､・ｨ・懍│夋晝ｲｽ嵂･・ｼ 嶹菩攤﨑ｩ・壱共"))
	ENDIF
[ENDIF]

PRINTL 
;OriginalString : (HTMLBUTTON("[888] - ・ｬ・・像・懍└・・, "888", "・ｬ・√・陦ｨ遉ｺ/髱櫁｡ｨ遉ｺ繧定ｨｭ螳壹＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[888] - ・ｬ・・像・懍└・・, "888", "・ｬ・・攪 岺懍亨/・・像・罹･ｼ ・､・倣鮒・壱共"))
DRAWLINE


;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｷ繝ｧ繝・・繝｡繝九Η繝ｼ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@USERSHOP
IF RESULT == 100 && TARGET >= 0
	BEGIN TRAIN
	RETURN 1
ELSEIF RESULT == 101
	CALL SHOW_CHARADATA
ELSEIF RESULT == 102 && TARGET >= 0
	CALL BONUS_GAIN
	RETURN 1
ELSEIF RESULT == 110 && CHARANUM > 2
	CALL CHANGE_TARGET_ASSI
ELSEIF RESULT == 155 && TARGET >= 0
	CALL CLOTHES_SETTING
ELSEIF RESULT == 177
	CALL DATABASE_OUTPUT
ELSEIF RESULT == 178
	CALL CONFIGURE
ELSEIF RESULT == 200
	;SAVEGAME
	;竊担YSTEM_DATAMENU.ERB
	CALL DATAMENU("SAVE")
ELSEIF RESULT == 300
	;LOADGAME
	;竊担YSTEM_DATAMENU.ERB
	CALL DATAMENU("LOAD")
ELSEIF RESULT == 888
	CALL KOJO_SET
ENDIF
;Emuera・罷ｲ・ｷｸ・ｨ・懆ｵｷ蜍墓凾
[IF_DEBUG]
	IF 0
	ELSEIF RESULT == 777
		PRINTFORML ・罷ｲ・ｷｸ・ｩ・・・肥┷・・ｼ 岺懍亨\@ FLAG:・罷ｲ・ｷｸ ? 縺励↑縺・# 縺吶ｋ \@・呟ｲ・・､・倣毎・ｵ・壱共
		FLAG:・罷ｲ・ｷｸ = !FLAG:・罷ｲ・ｷｸ ? 1 # 0
		WAIT
	ELSEIF RESULT == 778 && FLAG:・罷ｲ・ｷｸ && TARGET >= 0
		CFLAG:・壱･ += 10000
		PRINTFORML %CALLNAME%・・・壱･+10000・們来・ｵ・壱共
		WAIT
	ELSEIF RESULT == 779 && FLAG:・罷ｲ・ｷｸ
		PRINTW ・ｰ・・・・・ｼ溢｣ｼ・ｸ・ｵ・・・・・ｼ ・ｬ・､・倣腹 ・・・溢慣・壱共
		CALL MASTER_CUSTOM
		CALL BASE_MASTER_SETUP
	ELSEIF RESULT == 780 && FLAG:・罷ｲ・ｷｸ
		CALL FLAGCHECK
	ELSEIF RESULT == 781 && FLAG:・罷ｲ・ｷｸ
		CALL SET_AUTO
	ELSEIF RESULT == 782 && FLAG:・罷ｲ・ｷｸ
		CALL CHECK_TALENT_CRI
	ENDIF
[ENDIF]


@KOJO_SET
PRINTL ・尖ｦｭ奓ｰ ・川揆 ・ｴ・ｻ・・岺懍亨﨑ｩ・一ｹ鯉ｼ・PRINTL [0] - 岺懍亨OFF
PRINTL [1] - 岺懍亨ON縲窶ｻ・肥ｲ・$INPUT_LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		PRINTW ・尖ｦｭ奓ｰ ・川揆 岺懍亨﨑們ｧ ・喜慣・壱共
	CASE 1
		PRINTW ・尖ｦｭ奓ｰ ・川揆 岺懍亨﨑ｩ・壱共
	CASEELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
ENDSELECT
FLAG:・ｬ・・= RESULT
PRINTL 

;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;・・川梵/・ｰ・伜､画峩
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@CHANGE_TARGET_ASSI
#DIM OLD_T, 3

OLD_T = TARGET, (ASSI:1), (ASSI:2)

$CHANGE_LOOP
PRINTFORML ・ｰ・川梵/・ｰ・俯･ｼ ・・ｽ﨑 ・・・溢慣・壱共
CALL KOJO_COLOR(TARGET)
PRINTBUTTON @"[  0] ・ｰ・川梵 - \@ TARGET >= 0 ? [{TARGET,2}] %CALLNAME:TARGET% # ・ｰ・川梵・・・・慣・壱共 \@", 0
PRINTL 
RESETCOLOR
CALL KOJO_COLOR(ASSI:1)
PRINTBUTTON @"[  1] ・ｰ・・  - \@ ASSI:1 >= 0 ? [{ASSI:1,2}] %CALLNAME:(ASSI:1)% # ・ｰ・・(・)・・・・慣・壱共 \@", 1
PRINTL 
IF CHARANUM > 3
	RESETCOLOR
	CALL KOJO_COLOR(ASSI:2)
	PRINTBUTTON @"[  2] ・ｰ・・  - \@ ASSI:2 >= 0 ? [{ASSI:2,2}] %CALLNAME:(ASSI:2)% # ・ｰ・・(・)・・・・慣・壱共 \@", 2
	PRINTL 
ENDIF
IF TARGET < 0
	SETCOLOR 160, 160, 160
	PRINTFORML [---] ・ｰ・川梵・ｼ ・ｰ・倣紛 ・ｼ・ｸ・・	RESETCOLOR
ELSE
	RESETCOLOR
	PRINTFORML [  9] ・・ｽ ・・｣・ENDIF
$INPUT_LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		CALL CHANGE_TARGET
		GOTO CHANGE_LOOP
	CASE 1
		CALL CHANGE_ASSI(1)
		GOTO CHANGE_LOOP
	CASE 2
		IF CHARANUM > 3
			CALL CHANGE_ASSI(2)
			GOTO CHANGE_LOOP
		ENDIF
	CASE 9
		IF TARGET >= 0
			;・ｰ・・縺檎ｩｺ縺ｮ蝣ｴ蜷医・｡ｰ・・繧廷｡ｰ・・縺ｨ縺吶ｋ
			SIF ASSI:1 == -1
				SWAP ASSI:1, ASSI:2
			CALL CHANGE_TARGET_ASSI_MESSAGE(OLD_T)
			RETURN RESULT
		ENDIF
ENDSELECT
CLEARLINE 1
GOTO INPUT_LOOP

@CHANGE_TARGET_ASSI_MESSAGE(OLD_T)
#DIM LCOUNT
#DIM REF OLD_T, 0
#DIM NEW_T, 3

NEW_T = TARGET, (ASSI:1), (ASSI:2)

;螟画峩縺悟・縺剰｡後ｏ繧後※縺・↑縺・ｴ蜷・IF OLD_T:0 == NEW_T:0 && OLD_T:1 == NEW_T:1 && OLD_T:2 == NEW_T:2
	;・・川梵縺護｣ｼ・ｸ・倥・蝣ｴ蜷・	IF TALENT:TARGET:・ｼ・ｸ・・		PRINTFORMW %CALLNAME:TARGET%(・)・・・ｴ・・・・､・､・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・ｰ・・嵂壱共窶ｦ
	;縺昴ｌ莉･螟・	ELSE
		PRINTFORMW ・ｴ・・・CALLNAME:TARGET%・・%CALLNAME:MASTER%(・・・ｼ ・ｰ・川亨墲､・ｰ・・嵂壱共窶ｦ
	ENDIF
ENDIF
;・・川梵縺ｮ螟画峩縺瑚｡後ｏ繧後※縺・ｋ蝣ｴ蜷・IF OLD_T:0 != NEW_T:0
	;・ｬ・√・轤ｺ縺ｫ蟆ら畑螟画焚縺ｫ莠､莉｣蜈・・蜈医・・ｱ・晤ｲ逸从繧貞・繧後ｋ
	SHOP_OLDTARGET = OLD_T:0
	SHOP_NEWTARGET = NEW_T:0
	;譁ｰ・・川梵繧ｫ繝・ヨ繧､繝ｳ
	PRINTL
	CALL CHARA_CUTIN(CSTR:10, CSTR:11, CSTR:・罹ｧ溢梵)
	PRINTL
	;荳譎ら噪縺ｫTARGET繧呈立・・川梵縺ｫ謌ｻ縺・	TARGET = OLD_T:0
	;譌ｧ・・川梵・ｬ・∝他縺ｳ蜃ｺ縺・	CALL KOJO_EVENT(102)
	;・ｼ・ｸ・倪・・ｼ・ｸ・倅ｻ･螟悶∈縺ｮ螟画峩
	IF TARGET >= 0 && TALENT:TARGET:・ｼ・ｸ・・		PRINTFORMW %CALLNAME:TARGET%(・)・・%CALLNAME:SHOP_NEWTARGET%・・%CALLNAME:MASTER%・・・ｰ・尖･ｼ ・・メ嵂壱共窶ｦ
	;・ｼ・ｸ・倅ｻ･螟問・・ｼ・ｸ・倥∈縺ｮ螟画峩
	ELSEIF TALENT:SHOP_NEWTARGET:・ｼ・ｸ・・		PRINTFORMW %CALLNAME:SHOP_NEWTARGET%(・)・・・､・､・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・ｰ・・嵂壱共窶ｦ
	;・ｼ・ｸ・倅ｻ･螟問・・ｼ・ｸ・倅ｻ･螟悶∈縺ｮ螟画峩
	ELSE
		PRINTFORMW \@ TARGET >= 0 ? %CALLNAME:TARGET%・・・・﨑ｴ, # \@%CALLNAME:SHOP_NEWTARGET%﨑們ｧ・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・・・們来・､窶ｦ
	ENDIF
	;TARGET繧呈眠・・川梵縺ｫ
	TARGET = NEW_T:0
	;譁ｰ・・川梵・ｬ・∝他縺ｳ蜃ｺ縺・	CALL KOJO_EVENT(102, 1)
ENDIF
;譁ｰ・ｰ・伜・蜩｡繧定ｪｿ譟ｻ
FOR LCOUNT, 1, 3
	;・ｰ・廊COUNT縺梧眠隕丈ｻｻ蜻ｽ閠・・蝣ｴ蜷・	IF FINDLASTELEMENT(OLD_T, NEW_T:LCOUNT, 1) == -1
		;ASSI縺ｫ譁ｰ隕丈ｻｻ蜻ｽ閠・ｒ謖・ｮ・		ASSI = NEW_T:LCOUNT
		;・ｰ・倅ｻｻ蜻ｽ・ｬ・∝他縺ｳ蜃ｺ縺・		CALL KOJO_EVENT_ASSI(102)
		CALL VOIDLINE_IF(RESULT)
		;ASSI繧貞・縺ｫ謌ｻ縺・		ASSI = ASSI:1
	ENDIF
NEXT

;・・川梵・夋・@CHANGE_TARGET(ARG)
LOCALS = 
LOCALS += "<隴伜挨>CHANGE_TARGET"
LOCALS += "<荳企Κ>CHANGE_TARGET_SHOW"
LOCALS += "<譚｡莉ｶ>CHANGE_TARGET_REQU"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += ARG ? "<蜿匁ｶ・・ｨ・御ｸ榊庄" # "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
SIF RESULT != -1
	CALL SET_TARGET_ASSI(TARGET, 0, RESULT)

@CHANGE_TARGET_SHOW
PRINTFORML 嶸・椪 \@ TARGET >= 0 ? [{TARGET,2}] %CALLNAME:TARGET%・ ・ｰ・川､・# ・ｰ・川梵・・・・慣・壱共 \@
PRINTL ・ｴ・・・ｰ・川梵・・・・ｵｬ・・笈・鯉ｼ・
@CHANGE_TARGET_REQU(ARG)
RETURN ARG == 0 ? 0 # 1

;・ｰ・們│夋・@CHANGE_ASSI(ARG)
LOCALS = 
LOCALS += "<隴伜挨>CHANGE_TARGET"
LOCALS += @"<荳企Κ>CHANGE_ASSI_SHOW_{ARG}"
LOCALS += "<譚｡莉ｶ>CHANGE_TARGET_REQU"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += "<・夋・CHANGE_ASSI_CHOI"
LOCALS += "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
IF RESULT != -1
	SIF RESULT == -2
		RESULT = -1
	CALL SET_TARGET_ASSI(ASSI, ARG, RESULT)
ENDIF

@CHANGE_ASSI_SHOW_1
CALL CHANGE_ASSI_SHOW(1)
@CHANGE_ASSI_SHOW_2
CALL CHANGE_ASSI_SHOW(2)
@CHANGE_ASSI_SHOW(ARG)
IF ASSI:1 >= 0
	PRINTFORML 嶸・椪 [{ASSI:1,3}] %CALLNAME:(ASSI:1)%\@ ASSI:2 >= 0 ? 縲ー{ASSI:2,3}] %CALLNAME:(ASSI:2)% # \@縺護｡ｰ・・ELSE
	PRINTL 嶸・椪 ・ｰ・俯株 ・・慣・壱共
ENDIF
PRINTFORML ・ｴ・・・ｰ・・ARG}(・)・・・・ｵｬ・・笈・鯉ｼ・PRINTFORML 縲[0]縲護螺・後坂ｻ・ｰ・・ARG}(・・・ｼ ・・倣葺・ ・喜慣・壱共

@CHANGE_ASSI_CHOI(ARGS)
IF ARGS == "0"
	RESULTS '= "-2"
	RETURN 0
ENDIF
RETURN 1

;・・川梵/・ｰ・倥・莉ｻ蜻ｽ縺ｫ蠢懊§縺ｦ驕ｩ螳懃焚蜍輔・隗｣莉ｻ繧定｡後≧
@SET_TARGET_ASSI(LREF, ARG, ARG:1)
#DIM REF LREF,0
;蜑堺ｻｻ閠・→蠖ｹ蜑ｲ縺ｮ莠､謠帙ｒ陦後≧
LOCAL = LREF:ARG
IF ARG:1 != -1
	TARGET = TARGET == ARG:1 ? LOCAL # TARGET
	ASSI:1 = ASSI:1 == ARG:1 ? LOCAL # ASSI:1
	ASSI:2 = ASSI:2 == ARG:1 ? LOCAL # ASSI:2
ENDIF
;蠖ｹ蜑ｲ縺ｮ莉ｻ蜻ｽ繧定｡後≧
LREF:ARG = ARG:1
;ASSI繧定ｨｭ螳・ASSI = ASSI:1

;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｭ繝｣繝ｩ縺ｮ繧ｹ繝・・繧ｿ繧ｹ陦ｨ遉ｺ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@SHOW_CHARADATA(ARG)
LOCALS = 
LOCALS += "<隴伜挨>SHOW_CHARADATA"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
;・護符・・ｰ・夋晄凾閼ｱ蜃ｺ
SIF RESULT < 0
	RETURN 0
LOCAL = RESULT
;繧ｹ繝・・繧ｿ繧ｹ陦ｨ遉ｺ
CALL PRINT_STATUS(RESULT)
;蜀肴緒逕ｻ
RESTART

@SHOW_CHARADATA_PAD
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM L_SELECT
#DIM L_CHARA, 4
#DIM LINE
LINE = LINECOUNT
L_SELECT = 0
L_CHARA = MASTER, TARGET, ASSI:1, ASSI:2
$START
CLEARLINE LINECOUNT - LINE

DRAWLINE
FOR LOCAL, 0, 4
	SIF L_CHARA:LOCAL == -1
		CONTINUE
	SIF LOCAL == L_SELECT
		SETCOLOR 0x7070C0
	LOCALS = 
	LOCALS += @" %CALLNAME:LOCAL,16,LEFT% ・ｴ・･({MAX(BASE:LOCAL:0,0),4}/{MAXBASE:LOCAL:0,4}) "
	LOCALS += @" [LV {CFLAG:LOCAL:0,2} NEXT {CFLAG:LOCAL:﨑・囈・ｽ嵭們ｹ・- CFLAG:LOCAL:1,6}]"
	LOCALS += AUTO_SPLIT("_・・川梵_・ｰ・假ｼ狙・ｰ・假ｼ・, "_", LOCAL)
	SIF TALENT:(L_CHARA:LOCAL):・ｼ・ｸ・・		LOCALS += "<・ｼ・ｸ・・"
	PRINTBUTTON LOCALS, UNICODE(10000 + LOCAL)
	RESETCOLOR
	PRINTL 
	SIF LOCAL == 0
		DRAWLINE
NEXT
DRAWLINE
PRINTBUTTON "[" + KEYMARK_B+ "] - ・護符・ｨ・､", KEY_B
ONEINPUTS
SELECTCASE RESULTS
	CASE KEY_A
		CALL PRINT_STATUS, L_CHARA:L_SELECT
	CASE KEY_B
		RETURN 0
	CASE KEY_UP
		DO 
			SIF --L_SELECT == -1
				L_SELECT = 3
		LOOP L_CHARA:L_SELECT == -1
	CASE KEY_DOWN
		L_SELECT++
		SIF L_CHARA:L_SELECT == -1
			L_SELECT = 0
ENDSELECT
GOTO START
@FLAGCHECK
PRINTL [0] - ・護符・ｨ・､
PRINTL [1] - FLAG
PRINTL [2] - CFLAG
PRINTL [3] - FLAG・・・､嵓・PRINTL [4] - CFLAG・・・､嵓・$INPUT_LOOP1
INPUT
SELECTCASE RESULT
	CASE 0
	CASE 1
		VARSIZE FLAG
		LOCAL = RESULT
		PRINTFORML FLAG・逸从(0・桀LOCAL-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP2
		INPUT
		IF RESULT < 0 || LOCAL <= RESULT
			CLEARLINE 1
			REUSELASTLINE FLAG縺ｮ遽・峇縺ｯ(0・桀LOCAL-1})縺ｧ縺吶・			GOTO INPUT_LOOP2
		ENDIF
		PRINTFORMW FLAG:{RESULT} = {FLAG:RESULT}
		RESTART
	CASE 2
		PRINTFORML ・・・・尖ｦｭ奓ｰ・・・ｱ・・・逸从(0・桀CHARANUM-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP3
		INPUT
		IF RESULT < 0 || CHARANUM <= RESULT
			CLEARLINE 1
			REUSELASTLINE 蟄伜惠縺励∪縺帙ｓ縲・			GOTO INPUT_LOOP3
		ENDIF
		LOCAL = RESULT
		VARSIZE CFLAG
		LOCAL:1 = RESULT
		PRINTFORML %CALLNAME:LOCAL%﨑們ｧ・・・夋晤据・溢慣・壱共.
		PRINTFORML CFLAG・逸从(0・桀LOCAL:1-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP4
		INPUT
		IF RESULT < 0 || LOCAL:1 <= RESULT
			CLEARLINE 1
			REUSELASTLINE CFLAG縺ｮ遽・峇縺ｯ(0・桀LOCAL:1-1})縺ｧ縺・			GOTO INPUT_LOOP4
		ENDIF
		PRINTFORMW %CALLNAME:LOCAL%・呂FLAG:{RESULT} = {CFLAG:LOCAL:RESULT}
		RESTART
	CASE 3
		PRINTL FLAG・ｼ・・・廷擽0・・・・捩 ・晤楫)
		FOR LOCAL, 0, VARSIZE("FLAG")
			SIF FLAG:LOCAL
				PRINTFORMLC [FLAG:{LOCAL,4}={FLAG:LOCAL,10}]
		NEXT
		WAIT
		RESTART
	CASE 4
		PRINTFORML ・・・・尖ｦｭ奓ｰ・・・ｱ・・・逸从(0・桀CHARANUM-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP5
		INPUT
		IF RESULT < 0 || CHARANUM <= RESULT
			CLEARLINE 1
			REUSELASTLINE 蟄伜惠縺励∪縺帙ｓ縲・			GOTO INPUT_LOOP5
		ENDIF
		PRINTFORML %CALLNAME:RESULT%・呂FLAG・ｼ・・・廷擽0・・・・捩 ・晤楫)
		FOR LOCAL, 0, VARSIZE("CFLAG")
			SIF CFLAG:RESULT:LOCAL
				PRINTFORMLC [CFLAG:{LOCAL,4}={CFLAG:RESULT:LOCAL,10}]
		NEXT
		WAIT
		RESTART
	CASEELSE
		CLEARLINE 1
		GOTO INPUT_LOOP1
ENDSELECT

@SET_AUTO
#DIM SELECT
#DIM LINE
#DIMS 繧ｻ繝・ヨ蜷・ 5
#LOCALSSIZE 100
REDRAW 0
SELECT = -1
VARSET LOCALS
LINE = LINECOUNT
FOR LOCAL, 0, 5
	SIF !STRCOUNT(GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}", "_")
		GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}" = ・ｱ・掉LOCAL}_%GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}"%
	SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}", "_", RESULTS
	繧ｻ繝・ヨ蜷・LOCAL = %RESULTS%
NEXT
SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
SPLIT RESULTS:1, "/", LOCALS
$START
;蜑企勁繧ｳ繝槭Φ繝牙所縺ｳ・ｴ・∝､縺ｮ繝√ぉ繝・け
FOR LOCAL, 0, 100
	SIF LOCALS:LOCAL == ""
		CONTINUE
	SIF GETNUM(TRAINNAME, LOCALS:LOCAL) >= 0 || LOCALS:LOCAL == "・ｴ・ｨ・罷劇・・
		CONTINUE
	ARRAYREMOVE LOCALS, LOCAL, 1
	LOCAL--
NEXT
;遨ｺ陦後・謨ｴ逅・FOR LOCAL, 0, 100 - MATCH(LOCALS, "")
	SIF LOCALS:LOCAL != ""
		CONTINUE
	ARRAYREMOVE LOCALS, LOCAL, 1
	LOCAL--
NEXT
;譁ｰ隕剰ｿｽ蜉蜿危胸嵂壱共繧ｳ繝槭Φ繝峨・繝√ぉ繝・け
FOR LOCAL, 0, 100
	SIF TRAINNAME:LOCAL == ""
		CONTINUE
	;莉墓ｧ倅ｸ器・・・│夋昴〒縺阪ｋ縺ｨ蝠城｡後′縺ゅｋ縺ｮ縺ｧ繧ｫ繝・ヨ縺励※縺翫￥
	SIF TRAINNAME:LOCAL == "・ｴ・ｨ・罷劇・・
		CONTINUE
	SIF FINDELEMENT(LOCALS, TRAINNAME:LOCAL) >= 0
		CONTINUE
	LOCALS:(100 - MATCH(LOCALS, "")) = %TRAINNAME:LOCAL%
NEXT
CLEARLINE LINECOUNT - LINE
DRAWLINE
PRINTBUTTON @"・､奝・ｨ・・%\@FLAG:・､奝・ｨ・・> 0?・ｯ・ｮ#・ｯ・ｦ・ｦ\@%>", 1000
IF FLAG:・､奝・ｨ・・> 0
	PRINT 縲
	PRINTBUTTON @"・ｽ・ｼ繧ｿ繝ｼ繝ｳ謨ｰ<{FLAG:・､奝・ｨ・怡>", 1001
ENDIF
PRINTL 
DRAWLINE
PRINTFORML <%繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ)%>
FOR LOCAL, 0, 100
	SIF LOCALS:LOCAL == ""
		BREAK
	SIF LOCAL == SELECT
		SETCOLOR 0xC07070
	PRINTBUTTON @"%"["+LOCALS:LOCAL+"]",24,LEFT% > ", LOCAL
	SIF LOCAL % 4 == 3
		PRINTL 
	RESETCOLOR
NEXT
PRINTL 
DRAWLINE
PRINTL <・ｸ孖ｸ>
FOR LOCAL, 0, 5
	SIF LOCAL == FLAG:・夋晧┷孖ｸ
		SETCOLOR 0xC07070
	PRINTBUTTON @"%"["+繧ｻ繝・ヨ蜷・LOCAL+"]",25,LEFT%", 2000 + LOCAL
	RESETCOLOR
	SIF LOCAL % 3 == 2
		PRINTL 
NEXT
SIF !LINEISEMPTY()
	PRINTL 
DRAWLINE
PRINTL <・ｸ孖ｸ ・ｰ・・
PRINTBUTTON "[・・ｹｭ ・・ｽ]縲", 2010
PRINT 縲
PRINTBUTTON "[・ｱ・拆縲縲", 2011
PRINT 縲
PRINTBUTTON "[・ｬ・駈敢]", 2012
PRINTL 
DRAWLINE
PRINTL <・被抄孖ｸ ・ｸ孖ｸ>
PRINTBUTTON "[・逸从・懍・]縲縲", 2020
PRINT 縲
PRINTBUTTON "[・懍｢・縲縲", 2021
PRINT 縲
PRINTBUTTON "[・倆墳・‐縲", 2022
PRINTL 
DRAWLINE
PRINTL <岺懍亨 ・､・・
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 0
	SETCOLOR 0xC07070
PRINTBUTTON "[奝ｵ・‐縲縲", 2030
RESETCOLOR
PRINT 縲
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 1
	SETCOLOR 0xC07070
PRINTBUTTON "[・・楫]縲縲", 2031
PRINT 縲
RESETCOLOR
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 2
	SETCOLOR 0xC07070
;PRINTBUTTON "[・罷ｲ・ｷｸ髱櫁｡ｨ遉ｺ]", 2032
RESETCOLOR
PRINTL 
DRAWLINE
PRINTL <・ｰ・ ・・護｡ｱ ・ｴ・溢侃>
PRINTBUTTON "["+AUTO_SPLIT("・ｸ・罹ｘ ・・・・ｴ・川揆 ・ｴ・ｭ嶸/・母ｳ・・ｰ・ｬ・ｼ・/・ｩ・ｬ﨑俾ｲ・﨑ｴ/・卓・・・ｬ・・﨑ｴ/・晝ｰ・・・語ｹ護ｧ 﨑ｴ/・野乱 ・俾ｰ・ ・ｶ・､/・餓┷・/・ｬ・・﨑ｴ/・一ｸｰ・ ・ｶ・､/・餓ぎ﨑俾ｳ ・ｶ・､/・・ｬ・醐紛/・罹墾", "/", FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 % 100)+"]", 3000
PRINTL 
PRINTBUTTON "["+AUTO_SPLIT("・ｸ・罹ｘ ・・・・ｴ・川揆 ・ｴ・ｭ嶸/・母ｳ・・ｰ・ｬ・ｼ・/・ｩ・ｬ﨑俾ｲ・﨑ｴ/・卓・・・ｬ・・﨑ｴ/・晝ｰ・・・語ｹ護ｧ 﨑ｴ/・野乱 ・俾ｰ・ ・ｶ・､/・餓┷・/・ｬ・・﨑ｴ/・一ｸｰ・ ・ｶ・､/・餓ぎ﨑俾ｳ ・ｶ・､/・・ｬ・醐紛/・罹墾", "/", FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100)+"]", 3001
PRINTL (・壱ｹ・
DRAWLINE
PRINTBUTTON "[・護符・ｨ・､]", 999
INPUT
SELECTCASE RESULT
	CASE 2000 TO 2004
		IF FLAG:・夋晧┷孖ｸ != RESULT - 2000
			FLAG:・夋晧┷孖ｸ = RESULT - 2000
			SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
			SPLIT RESULTS:1, "/", LOCALS
		ENDIF
	CASE 2010
		PRINTL ・・ｹｭ・・・・･﨑ｴ ・ｼ・ｸ・・		INPUTS
		SIF RESULTS == ""
			RESULTS = ・ｱ・掉FLAG:・夋晧┷孖ｸ}
		繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ) = %RESULTS%
	CASE 2011, 999
		PRINTW 嶸・椪・ｸ孖ｸ・ｼ ・ｱ・晨鮒・壱共
		GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" = %繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ)%_
		FOR LOCAL, 0, 100 - MATCH(LOCALS, "")
			SIF LOCALS:LOCAL == ""
				BREAK
			GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" += LOCALS:LOCAL
			GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" += "/"
		NEXT
		;譛ｫ蟆ｾ縺ｮ蛹ｺ蛻・ｊ險伜捷繧貞炎繧・		GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" = %SUBSTRING(GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", 0, STRLENS(GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}") - 1)%
		SAVEGLOBAL
		IF RESULT == 999
			CALL AUTO_MODE, 1
			REDRAW 1
			RETURN 0
		ENDIF
	CASE 2012
		SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
		SPLIT RESULTS:1, "/", LOCALS
	CASE 2020
		VARSET LOCALS
	CASE 2021
		VARSET LOCALS
		LOCALS += "・・菩揆 ・ｴ・・﨑罹共/嵭壱ｦｬ・ｼ 彧罷蕩・､/・・醐紛・假ｼ・・溢乱 ・ｴ!/・・ｷｹ・・愍・・﨑罹共/・語ｰ川揆 ・幗符・､・ｸ・､/・ｰ・・｢苦ｲ・﨑ｴ/・・Η﨑俾ｲ・・瀧況﨑罹共/・・﨑俯糖﨑俾ｲ・﨑ｴ/"
		LOCALS += "・語ｷｹ・・愍・・﨑罹共/・ｩ・罹･ｼ ・誤共/・・・洳・醐復・､/・溢搆 ・ｽ﨑俾ｲ・・瀧況﨑罹共/・ｨ・ｵ﨑罹共/・ｴ・晤圄﨑俾ｲ・・瀧況﨑罹共/・倣葺・・・瀧況﨑罹共/・溢母ｱｰ・ｰ・､/・語ｰ川揆 ・ｸ・罷共/"
		LOCALS += "・・ｪ・ｧ・ｸ・､/・奝ｵ・・・ｸ・罷共/・川怱・ｼ ・懍梠﨑罹共/・ｫ・ｴ﨑罹共/・懦握・ｴ・､・ ・ｨ・倣復・､/・・螺・ｴ ・・株・､/・ｴ・懍寥﨑罹共/"
		LOCALS += "・溢乱 ・ｴ・ｴ ・壱松!/・ｰ・﨑罹共/・・ｴ・､/・・ｵｬ・ｼ ・懋ｱｰ﨑罹共"
		SPLIT LOCALS, "/", LOCALS
	CASE 2022
		VARSET LOCALS
		LOCALS += "・・ｴ・､/・・ｵｬ・ｼ ・懋ｱｰ﨑罹共/・ｰ・﨑罹共/・溢乱 ・ｴ・ｴ ・壱松!/"
		LOCALS += "・懦握・ｴ・､・ ・ｨ・倣復・､/・ｫ・ｴ﨑罹共/・・螺・ｴ ・・株・､/・・ｪ・ｧ・ｸ・､/・奝ｵ・・・ｸ・罷共/・川怱・ｼ ・懍梠﨑罹共/・ｴ・懍寥﨑罹共/"
		LOCALS += "・語ｷｹ・・愍・・﨑罹共/・ｩ・罹･ｼ ・誤共/・・・洳・醐復・､/・溢搆 ・ｽ﨑俾ｲ・・瀧況﨑罹共/・ｨ・ｵ﨑罹共/・ｴ・晤圄﨑俾ｲ・・瀧況﨑罹共/・倣葺・・・瀧況﨑罹共/・溢母ｱｰ・ｰ・､/・語ｰ川揆 ・ｸ・罷共/"
		LOCALS += "・溢乱 ・ｴ!/・・ｷｹ・・愍・・﨑罹共/・語ｰ川揆 ・幗符・､・ｸ・､/・ｰ・・｢苦ｲ・﨑ｴ/・・Η﨑俾ｲ・・瀧況﨑罹共/・・﨑俯糖﨑俾ｲ・﨑ｴ/・・菩揆 ・ｴ・・﨑罹共/嵭壱ｦｬ・ｼ 彧罷蕩・､/・・醐紛・假ｼ・
		SPLIT LOCALS, "/", LOCALS
	CASE 2030, 2031, 2032
		FLAG:・､奝・ｨ・懦像・懍└・・= RESULT - 2030
	CASE 3000
		IF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 % 100 == 12
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 -= 12
		ELSE
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃++
		ENDIF
	CASE 3001
		IF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100 == 12
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 -= 900
		ELSEIF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100 == 5
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 += 300
		ELSE
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 += 100
		ENDIF
		
	CASE 1001
		IF FLAG:・､奝・ｨ・・> 0
			CALL INPUT_MANY, 1, 100
			FLAG:・､奝・ｨ・・= RESULT
		ENDIF
	CASE 1000
		IF !FLAG:・､奝・ｨ・・			FLAG:・､奝・ｨ・・= 1
		ELSE
			FLAG:・､奝・ｨ・・*= -1
		ENDIF
	CASEELSE
		IF SELECT == -1
			SELECT = RESULT
		ELSE
			SWAP LOCALS:SELECT, LOCALS:RESULT
			SELECT = -1
		ENDIF
ENDSELECT
GOTO START

@CHECK_TALENT_CRI
#LOCALSIZE 10
#LOCALSSIZE 200
#DIM LINE
#DIM LINENUM, 2
#DIM LCHARANUM
#DIM LMASTER
#DIM LTARGET
#DIM LTEMP
#DIMS LTEMPS

#DIM LVAR, 30
#DIM LSEX_CRI, 30
#DIM LMAIDEN_CRI, 30

#DIM LTALENT_CRI_EX, 1000
#DIM LTALENT_MENU_CRI, 1000, 20
#DIM LTALENT_CRI, 1000, 20, 30

#DIMS LSEX_OPTION
#DIM LFAVOR_OPTION
#DIM LMAIDEN_OPTION
#DIM LFUTANARI_OPTION

LCHARANUM = CHARANUM
LMASTER = MASTER
LTARGET = TARGET
LINENUM = 15, 35

LSEX_OPTION = 諤ｧ蛻･辟｡隕・LMAIDEN_OPTION = 1

VARSET LTALENT_MENU_CRI:0:0
VARSET LTALENT_CRI:0:0:0
FOR LOCAL, 0, VARSIZE("TALENT")
	SIF TALENTNAME:LOCAL == ""
		CONTINUE
	ADDVOIDCHARA
	TARGET = CHARANUM - 1
	TALENT:LOCAL = 1
	;螟画焚繧貞・譛溷喧
	CALL SET_CRI_VAR
	FOR LOCAL:1, 0, 11
		;弴ｴ・昴ｒ縺ｯ縺倥￥
		;・ｬ・ｭ縺ｯ蜃ｦ逅・＠縺ｪ縺・		SIF LOCAL:1 == 8 || LOCAL:1 == 9
			CONTINUE
		CALL SET_CRI_VAR, MENU(LOCAL:1), 1
	NEXT
	CALL ACT_MENU_TALENT_T
	VARSET LVAR
	VARSET RESULT
	CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
	FOR LOCAL:1, 0, 20
		LTALENT_MENU_CRI:LOCAL:(LOCAL:1) += RESULT:(LOCAL:1) * 2
	NEXT
	VARSET RESULT
	CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
	FOR LOCAL:1, 0, 20
		LTALENT_MENU_CRI:LOCAL:(LOCAL:1) += RESULT:(LOCAL:1)
		SIF LTALENT_MENU_CRI:LOCAL:(LOCAL:1)
			LTALENT_CRI_EX:LOCAL = 1
	NEXT
	FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
		CALL RES_CRI_VAR, 1
		CALL ACT_M_INIT(LOCAL:1)
		TRYCCALLFORM ACT_ACTM{LOCAL:1}_TALENT_T
		CATCH
			CONTINUE
		ENDCATCH
		VARSET LVAR
		VARSET RESULT
		CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
		FOR LOCAL:2, 0, 30
			LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2) += RESULT:(LOCAL:2) * 2
		NEXT
		CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
		FOR LOCAL:2, 0, 30
			LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2) += RESULT:(LOCAL:2)
			SIF LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2)
				LTALENT_CRI_EX:LOCAL = 1
		NEXT
	NEXT
	DELCHARA TARGET
NEXT
TARGET= LTARGET
$START
DRAWLINE
LOCALS = 邏雉ｪ隗｣譫・繧ｭ繝｣繝ｩ繧ｯ繧ｿ繝ｼ謖・ｮ・邨ゆｺ・LOCAL = 0
WHILE AUTO_SPLIT(LOCALS, "/", LOCAL) != ""
	PRINTBUTTON "[" + AUTO_SPLIT(LOCALS, "/", LOCAL) +"]", AUTO_SPLIT(LOCALS, "/", LOCAL) 
	PRINTL 
	LOCAL++
WEND
CALL INPUT_SPLIT, LOCALS
SELECTCASE RESULTS
	CASE "邏雉ｪ隗｣譫・
		$START_TALENT
		LOCALS:1 = 
		LOCAL:1 = 0
		FOR LOCAL, 0, VARSIZE("TALENT") + 2
			IF LOCAL == VARSIZE("TALENT") + 1
				LOCALS:1 += "END"
				PRINTBUTTON @"%"[・護符・ｨ・､]", 16, LEFT%", "END"
			ELSEIF LOCAL == VARSIZE("TALENT")
				LOCALS:1 += "ALL/"
				PRINTBUTTON @"%"[・・・・・", 16, LEFT%", "ALL"
			ELSE
				SIF !LTALENT_CRI_EX:LOCAL
					CONTINUE
				LOCALS:1 += TALENTNAME:LOCAL + "/"
				PRINTBUTTON @"%"[" + TALENTNAME:LOCAL +"]", 16, LEFT%", TALENTNAME:LOCAL
			ENDIF
			SIF LOCAL:1 % 6 == 0
				PRINTL 
			LOCAL:1++
		NEXT
		SIF !LINEISEMPTY()
			PRINTL 
		CALL INPUT_SPLIT, LOCALS:1
		SIF RESULTS == "END"
			GOTO START
		FOR LOCAL, 0, VARSIZE("TALENT")
			IF RESULTS == "ALL"
				SIF !LTALENT_CRI_EX:LOCAL
					CONTINUE
			ELSE
				SIF TALENTNAME:LOCAL != RESULTS
					CONTINUE
			ENDIF
			DRAWLINE
			PRINTFORML %TALENTNAME:LOCAL%
			FOR LOCAL:1, 0, 20
				LTEMP = LTALENT_MENU_CRI:LOCAL:(LOCAL:1)
				SIF !LTEMP
					CONTINUE
				PRINTFORM %MENU(LOCAL:1), 24, LEFT%
				IF LTEMP > 0
					SETCOLOR 0x7070C0
				ELSE
					SETCOLOR 0xC07070
				ENDIF
				PRINTFORML {LTEMP,4}
				RESETCOLOR
			NEXT
			FOR LOCAL:1, 0, 20
				FOR LOCAL:2, 0, 30
					LTEMP = LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2)
					SIF !LTEMP
						CONTINUE
					PRINTFORM %GET_ACTABBNAME(ACTM_NUM(LOCAL:1, LOCAL:2)) + "(" + MENU(LOCAL:1) + ")", 24, LEFT%
					IF LTEMP > 0
						SETCOLOR 0x7070C0
					ELSE
						SETCOLOR 0xC07070
					ENDIF
					PRINTFORML {LTEMP,4}
					RESETCOLOR
				NEXT
			NEXT
		NEXT
		WAIT
		GOTO START_TALENT
	CASE "繧ｭ繝｣繝ｩ繧ｯ繧ｿ繝ｼ謖・ｮ・
		$START_CHARA
		LOCALS:1 = END/・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ/諤ｧ蛻･辟｡隕・・・尖劇・√′逕ｷ/・・尖劇・√′螂ｳ/・・尖劇・√′弡・ム・俯ｦｬ/蛻昜ｽ馴ｨ鍋┌隕・・・尖劇・√′・俯・/嶸ｸ・伜ｰ・嶸ｸ・倅ｸｭ/嶸ｸ・伜､・		DRAWLINE
		FOR LOCAL, 1, FLAG:Cha・晧・ + 1
			LOCALS:1 += "/" + CSVCALLNAME(LOCAL, 0)
			PRINTBUTTON @"%"[" + CSVCALLNAME(LOCAL, 0) +"]", 24, LEFT%", CSVCALLNAME(LOCAL, 0)
			SIF LOCAL % 4 == 0
				PRINTL 
		NEXT
		SIF !LINEISEMPTY()
			PRINTL 
		DRAWLINE
		FOR LOCAL, 0 ,4
			LTEMPS = %AUTO_SPLIT("諤ｧ蛻･辟｡隕・・・尖劇・√′逕ｷ/・・尖劇・√′螂ｳ/・・尖劇・√′弡・ム・俯ｦｬ", "/", LOCAL)%
			SIF LTEMPS == LSEX_OPTION
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		SIF LFUTANARI_OPTION
			SETCOLOR 0x70C070
		PRINTBUTTON @"%"[・ｰ・川梵・ｼ ・懋ｻ瀧ｘ・・劇・・﨑罹共]", 24, LEFT%", "・ｰ・川梵・ｼ ・懋ｻ瀧ｘ・・劇・・﨑罹共"
		RESETCOLOR
		PRINTL 
		DRAWLINE
		FOR LOCAL, 0 ,2
			LTEMPS = %AUTO_SPLIT("蛻昜ｽ馴ｨ鍋┌隕・・・尖劇・√′・俯・", "/", LOCAL)%
			SIF GETBIT(LMAIDEN_OPTION, LOCAL)
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		PRINTL 
		FOR LOCAL, 0 ,3
			LTEMPS = %AUTO_SPLIT("嶸ｸ・伜ｰ・嶸ｸ・倅ｸｭ/嶸ｸ・伜､・, "/", LOCAL)%
			SIF LFAVOR_OPTION == LOCAL
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		PRINTL 
		DRAWLINE
		PRINTBUTTON @"%"[・護符・ｨ・､]", 24, LEFT%", "END"
		PRINTL 
		CALL INPUT_SPLIT, LOCALS:1
		SIF RESULTS == "END"
			GOTO START
		IF GROUPMATCH(RESULTS, "諤ｧ蛻･辟｡隕・, "・・尖劇・√′逕ｷ", "・・尖劇・√′螂ｳ", "・・尖劇・√′弡・ム・俯ｦｬ")
			LSEX_OPTION = %RESULTS%
			GOTO START_CHARA
		ENDIF
		IF GROUPMATCH(RESULTS, "・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ", "蛻昜ｽ馴ｨ鍋┌隕・, "・・尖劇・√′・俯・", "嶸ｸ・伜ｰ・, "嶸ｸ・倅ｸｭ", "嶸ｸ・伜､・)
			SIF RESULTS == "・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ"
				INVERTBIT LFUTANARI_OPTION, 0
			SIF RESULTS == "蛻昜ｽ馴ｨ鍋┌隕・
				INVERTBIT LMAIDEN_OPTION, 0
			SIF RESULTS == "・・尖劇・√′・俯・"
				INVERTBIT LMAIDEN_OPTION, 1
			SIF RESULTS == "嶸ｸ・伜ｰ・
				LFAVOR_OPTION = 0
			SIF RESULTS == "嶸ｸ・倅ｸｭ"
				LFAVOR_OPTION = 1
			SIF RESULTS == "嶸ｸ・伜､・
				LFAVOR_OPTION = 2
			GOTO START_CHARA
		ENDIF
		FOR LOCAL, 0, FLAG:Cha・晧・ + 1
			SIF RESULTS != CSVCALLNAME(LOCAL, 0)
				CONTINUE
			ADDCHARA LOCAL
			BREAK
		NEXT
		TARGET = CHARANUM - 1
		ADDVOIDCHARA
		MASTER = CHARANUM - 1
		SIF LSEX_OPTION == "・・尖劇・√′逕ｷ"
			TALENT:MASTER:・ｨ・・= 1
		SIF LSEX_OPTION == "・・尖劇・√′弡・ム・俯ｦｬ"
			TALENT:MASTER:弡・ム・俯ｦｬ = 1
		SIF LFUTANARI_OPTION
			TALENT:弡・ム・俯ｦｬ = 1
		SIF GETBIT(LMAIDEN_OPTION, 1)
			TALENT:MASTER:・俯・ = 1
		CFLAG:嶸ｸ・・= LFAVOR_OPTION * 1000
		DRAWLINE
		PRINTFORML 縲%CALLNAME:TARGET%
		;螟画焚繧貞・譛溷喧
		CALL SET_CRI_VAR
		FOR LOCAL:1, 0, 11
			;弴ｴ・昴ｒ縺ｯ縺倥￥
			;・ｬ・ｭ縺ｯ蜃ｦ逅・＠縺ｪ縺・			SIF LOCAL:1 == 8 || LOCAL:1 == 9
				CONTINUE
			CALL SET_CRI_VAR, MENU(LOCAL:1), 1
		NEXT
		LINE = LINECOUNT
		DRAWLINE
		PRINTFORML 縲・罷俺 ・夋・		DRAWLINE
		VARSET LVAR
		VARSET RESULT
		VARSET LSEX_CRI
		VARSET LMAIDEN_CRI
		IF LSEX_OPTION != "諤ｧ蛻･辟｡隕・
			CALL CHA_CRI_VAR, "諤ｧ蛻･"
			CALL ACT_MENU_SEX
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
		ENDIF
		IF !GETBIT(LMAIDEN_OPTION, 0)
			VARSET RESULT
			CALL CHA_CRI_VAR, "・・川梵縺護ｲ俯・"
			CALL ACT_MENU_MAIDEN_T
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
			VARSET RESULT
			CALL CHA_CRI_VAR, "・・尖劇・√′・俯・"
			CALL ACT_MENU_MAIDEN_M
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
		ENDIF
		CALL CHA_CRI_VAR, "邏雉ｪ"
		VARSET RESULT
		CALL ACT_MENU_TALENT_T
		CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
		FOR LOCAL:1, 0, 30
			LVAR:(LOCAL:1) += RESULT:(LOCAL:1) * 2
		NEXT
		CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
		FOR LOCAL:1, 0, 30
			LVAR:(LOCAL:1) += RESULT:(LOCAL:1)
		NEXT
		FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
			SETCOLOR 0xC07070
			PRINTFORM %UNICODE(0x25AE) * ABS(MIN(LVAR:(LOCAL:1), 0)),50,RIGHT%
			RESETCOLOR
			PRINTFORM  %MENU(LOCAL:1)%({LVAR:(LOCAL:1), 4}) 
			SETCOLOR 0x7070C0
			PRINTFORM %UNICODE(0x25AE) * MAX(LVAR:(LOCAL:1), 0),50,LEFT%
			PRINTFORML 
		NEXT
		WHILE LINECOUNT < LINE + LINENUM
			PRINTFORML 
		WEND
		RESETCOLOR
		LOCAL:3 = 0
		FOR LOCAL:1, 0, VARSIZE("TALENT")
			SIF !TALENT:(LOCAL:1)
				CONTINUE
			LTEMPS = 
			FOR LOCAL:2, 0, STRCOUNT(MENULIST(), "/") + 1
				IF LTALENT_MENU_CRI:(LOCAL:1):(LOCAL:2)
					SIF LTEMPS != ""
						LTEMPS += "/"
					LTEMPS += MENU(LOCAL:2) + "_" + TOSTR(LTALENT_MENU_CRI:(LOCAL:1):(LOCAL:2))
				ENDIF
			NEXT
			IF LTEMPS != ""
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %TALENTNAME:(LOCAL:1), 16, LEFT%
				SPLIT LTEMPS, "/", LOCALS
				FOR LOCAL:2, 0, RESULT
					LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
		NEXT
		IF MATCH(LMAIDEN_CRI, 0) != VARSIZE("LMAIDEN_CRI")
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %"蛻昜ｽ馴ｨ畷ｳｴ・・, 16, LEFT%
			FOR LOCAL:2, 0, 30
				SIF !LMAIDEN_CRI:(LOCAL:2)
					CONTINUE
				LTEMP = LMAIDEN_CRI:(LOCAL:2)
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%MENU(LOCAL:2)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		ENDIF
		IF MATCH(LSEX_CRI, 0) != VARSIZE("LSEX_CRI")
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %"諤ｧ蛻･・ｴ・・, 16, LEFT%
			FOR LOCAL:2, 0, 30
				SIF !LSEX_CRI:(LOCAL:2)
					CONTINUE
				LTEMP = LSEX_CRI:(LOCAL:2)
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%MENU(LOCAL:2)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		ENDIF
		LOCAL:3 = 0
		FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
			LTEMPS = 
			FOR LOCAL:2, 0, VARSIZE("TALENT")
				SIF !TALENT:(LOCAL:2)
					CONTINUE
				LTEMP = LTALENT_MENU_CRI:(LOCAL:2):(LOCAL:1)
				SIF !LTEMP
					CONTINUE
				LTEMPS += "/" + TALENTNAME:(LOCAL:2) + "_" + TOSTR(LTEMP)
			NEXT
			SIF LMAIDEN_CRI:(LOCAL:1)
				LTEMPS += "/" + "蛻昜ｽ馴ｨ畷ｳｴ・・ + "_" + TOSTR(LMAIDEN_CRI:(LOCAL:1))
			SIF LSEX_CRI:(LOCAL:1)
				LTEMPS += "/" + "諤ｧ蛻･・ｴ・・ + "_" + TOSTR(LSEX_CRI:(LOCAL:1))
			SIF LTEMPS == ""
				CONTINUE
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %MENU(LOCAL:1), 16, LEFT%
			SPLIT LTEMPS, "/", LOCALS
			FOR LOCAL:2, 1, RESULT
				LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		NEXT
		WHILE LINECOUNT < LINE + LINENUM:1
			PRINTFORML 
		WEND
		WAIT
		FOR LOCAL, 0, STRCOUNT(MENULIST(), "/") + 1
			CALL RES_CRI_VAR, 1
			CALL ACT_M_INIT(LOCAL)
			VARSET LVAR
			VARSET LSEX_CRI
			VARSET LMAIDEN_CRI
			VARSET RESULT
			IF !GETBIT(LMAIDEN_OPTION, 0)
				CALL CHA_CRI_VAR, "・・尖劇・√′・俯・"
				TRYCCALLFORM ACT_ACTM{LOCAL}_MAIDEN_M
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
				CALL CHA_CRI_VAR, "・・川梵縺護ｲ俯・"
				TRYCCALLFORM ACT_ACTM{LOCAL}_MAIDEN_T
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
			ENDIF
			IF LSEX_OPTION != "諤ｧ蛻･辟｡隕・
				CALL CHA_CRI_VAR, "諤ｧ蛻･"
				TRYCCALLFORM ACT_ACTM{LOCAL}_GENDER_T
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
			ENDIF
			CALL CHA_CRI_VAR, "邏雉ｪ"
			TRYCCALLFORM ACT_ACTM{LOCAL}_TALENT_T
			CATCH
			ENDCATCH
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LVAR:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LVAR:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
			LINE = LINECOUNT
			DRAWLINE
			PRINTFORML 縲%MENU(LOCAL)%
			DRAWLINE
			FOR LOCAL:1, 0, ACTM_NUM(LOCAL)
				SETCOLOR 0xC07070
				PRINTFORM %UNICODE(0x25AE) * ABS(MIN(LVAR:(LOCAL:1), 0)),50,RIGHT%
				RESETCOLOR
				PRINTFORM  %GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:1))%({LVAR:(LOCAL:1), 4}) 
				SETCOLOR 0x7070C0
				PRINTFORM %UNICODE(0x25AE) * MAX(LVAR:(LOCAL:1), 0),50,LEFT%
				PRINTFORML 
			NEXT
			WHILE LINECOUNT < LINE + LINENUM
				PRINTFORML 
			WEND
			RESETCOLOR
			LOCAL:3 = 0
			FOR LOCAL:1, 0, VARSIZE("TALENT")
				SIF !TALENT:(LOCAL:1)
					CONTINUE
				LTEMPS = 
				FOR LOCAL:2, 0, ACTM_NUM(LOCAL)
					IF LTALENT_CRI:(LOCAL:1):LOCAL:(LOCAL:2)
						SIF LTEMPS != ""
							LTEMPS += "/"
						LTEMPS += GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2)) + "_" + TOSTR(LTALENT_CRI:(LOCAL:1):LOCAL:(LOCAL:2))
					ENDIF
				NEXT
				IF LTEMPS != ""
					SIF LOCAL:3++ == 0
						DRAWLINE
					PRINTFORM %TALENTNAME:(LOCAL:1), 16, LEFT%
					SPLIT LTEMPS, "/", LOCALS
					FOR LOCAL:2, 0, RESULT
						LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
						SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
						PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
						RESETCOLOR
					NEXT
					PRINTL 
				ENDIF
			NEXT
			IF MATCH(LMAIDEN_CRI, 0) != VARSIZE("LMAIDEN_CRI")
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %"蛻昜ｽ馴ｨ畷ｳｴ・・, 16, LEFT%
				FOR LOCAL:2, 0, 30
					SIF !LMAIDEN_CRI:(LOCAL:2)
						CONTINUE
					LTEMP = LMAIDEN_CRI:(LOCAL:2)
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2))% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
			IF MATCH(LSEX_CRI, 0) != VARSIZE("LSEX_CRI")
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %"諤ｧ蛻･・ｴ・・, 16, LEFT%
				FOR LOCAL:2, 0, 30
					SIF !LSEX_CRI:(LOCAL:2)
						CONTINUE
					LTEMP = LSEX_CRI:(LOCAL:2)
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2))% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
			DRAWLINE
			FOR LOCAL:1, 0, ACTM_NUM(LOCAL)
				LTEMPS = 
				FOR LOCAL:2, 0, VARSIZE("TALENT")
					SIF !TALENT:(LOCAL:2)
						CONTINUE
					LTEMP = LTALENT_CRI:(LOCAL:2):LOCAL:(LOCAL:1)
					SIF !LTEMP
						CONTINUE
					LTEMPS += "/" + TALENTNAME:(LOCAL:2) + "_" + TOSTR(LTEMP)
				NEXT
				SIF LMAIDEN_CRI:(LOCAL:1)
					LTEMPS += "/" + "蛻昜ｽ馴ｨ畷ｳｴ・・ + "_" + TOSTR(LMAIDEN_CRI:(LOCAL:1))
				SIF LSEX_CRI:(LOCAL:1)
					LTEMPS += "/" + "諤ｧ蛻･・ｴ・・ + "_" + TOSTR(LSEX_CRI:(LOCAL:1))
				SIF LTEMPS == ""
					CONTINUE
				PRINTFORM %GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:1)), 16, LEFT%
				SPLIT LTEMPS, "/", LOCALS
				FOR LOCAL:2, 1, RESULT
					LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			NEXT
			WHILE LINECOUNT < LINE + LINENUM:1
				PRINTFORML 
			WEND
			WAIT
		NEXT
		WHILE CHARANUM > LCHARANUM
			DELCHARA CHARANUM -  1
		WEND
		GOTO START_CHARA
	CASE "邨ゆｺ・
		TARGET = LTARGET
		MASTER = LMASTER
		WHILE CHARANUM > LCHARANUM
			DELCHARA CHARANUM -  1
		WEND
		RETURN 1
ENDSELECT
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;・ｸ・ｴ・後う繝ｳ繝輔か		竊担YSTEM_DATAMENU.ERB縺ｫ縺ｦ莉｣譖ｿ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;@SAVEINFO
;PUTFORM {DAY+1}譌･逶ｮ%GET_TIME()% \@ TARGET >= 0 ? %CALLNAME:TARGET%縺・CALLNAME:MASTER%繧廷｡ｰ・川､・# \@


;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繝舌・繧ｸ繝ｧ繝ｳ繧｢繝・・
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@VERSION_UP

=======
・ｿ;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｷ繝ｧ繝・・繝｡繝九Η繝ｼ縺ｮ陦ｨ遉ｺ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@SHOW_SHOP
CALL VERSION_UP

DRAWLINE
PRINTFORML {FLAG:・ｰ・・1}・кFLAG:・ｼ・・1}・ｼ・ｸ(%GET_TIME()%) %GET_SEASON()% %GET_DAY()%・・嵂・縲・ｨ寬ｸ・假ｼ・CALLNAME:1%
SIF TARGET >= 0
	PRINTFORML %CALLNAME:MASTER%(・・・ｼ %CALLNAME:TARGET%・ｴ(・) ・ｰ・川､・
SIF ASSI:1 >= 0
	PRINTFORML ・溢｡ｰ・假ｼ托ｼ・CALLNAME:(ASSI:1)%・噂@ ASSI:2 >= 0 ? ・溢｡ｰ・假ｼ抵ｼ・CALLNAME:(ASSI:2)%・・# \@
HTML_PRINT HTML_BASE("・ｴ・･", MASTER, 0, 16) + HTML_BASE("・ｰ・･", MASTER, 1, 16)
SIF TARGET >= 0
	PRINTFORML (%CALLNAME%・・・壱･縲{CFLAG:・壱･})
[SKIPSTART]
隕√ｉ縺ｪ縺・→諤昴≧縺ｮ縺ｧ繧ｳ繝｡繝ｳ繝医い繧ｦ繝医＠縺ｦ縺翫″縺ｾ縺僉/L
IF TARGET >= 0
	PRINTFORML 縲川攪・ｴ・・test甯舌代(%CALLNAME%・・%CALLNAME:MASTER%・川攪 ・們｡ｴ・・ｼ嘴CFLAG:・們｡ｴ・м縲%CALLNAME:MASTER%・・%CALLNAME:(FLAG:・ｼ・ｸ・・%・､・専ｲ誤｡懍攪 ・們｡ｴ・・ｼ嘴CFLAG:MASTER:・們｡ｴ・м)
	PRINTL 縲・｡・ｳ・ｴ ・駆捩 ・・懍乱・懍攪 ・們ｹ俯･ｼ, ・ｨ寬ｸ・們攪 ・ｴ・・ｷ・ｼ・ｸ・ｵ・・・ｱ・・ 﨑 ・・・溢愍・ｴ ・・被復 嵓誤溢擽 ・ｩ・ｨ・・・呷流
	PRINTL 縲・､・・・ｱ・・・ｴ・﨑們共 ・・・溢愍・ｴ(・・ ・､嵂餓桿・壱共. ・罷畠 ・・ｸｰ・ｱ・・・ｬ・ｩ﨑 ・溢菩攪 ・廷桿・壱共.
ENDIF
[SKIPEND]
DRAWLINE
;・・宣幕蟋・
;OriginalString : (HTMLAUTOBUTTON("[100] - ・ｰ・川攪 ・懋ｰ・擽・､", "100", "・・舌ｒ髢句ｧ九＠縺ｾ縺・, , , TARGET >= 0, 
;CALL HTMLPRINTL(HTMLAUTOBUTTON("[100] - 隱ｿ謨吶・譎る俣縺梧擂縺・, "100", "隱ｿ謨吶ｒ髢句ｧ九＠縺ｾ縺・, , , TARGET >= 0, 
;"[---] - 隱ｿ謨呵・ｒ豎ｺ繧√※縺上□縺輔＞", "隱ｿ謨吶ｒ髢句ｧ九☆繧狗ぜ縺ｫ縺ｯ縲∬ｪｿ謨呵・ｒ豎ｺ螳壹☆繧句ｿ・ｦ√′縺ゅｊ縺ｾ縺・, 0xA0A0A0))
{
CALL HTMLPRINTL(HTMLAUTOBUTTON("[100] - ・ｰ・川攪 ・懋ｰ・擽・､", "100", "・・尖･ｼ ・懍亨﨑ｩ・壱共", , , TARGET >= 0, 
	"[---] - ・・川梵繧呈ｱｺ繧√※縺上□縺輔＞", "・・舌ｒ髢句ｧ九☆繧狗ぜ縺ｫ縺ｯ縲・｣・川梵繧呈ｱｺ螳壹☆繧駈符・斐′縺ゅｊ縺ｾ縺・, 0xA0A0A0))
}
;閭ｽ蜉幄｡ｨ遉ｺ
;OriginalString : (HTMLBUTTON("[101] - ・･・･・・岺懍亨", "101", "・・川梵縺ｨ・・尖劇・√・蜷・ｨｮ・ｽ嵭們ｹ倡ｭ峨ｒ遒ｺ隱阪＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[101] - ・･・･・・岺懍亨", "101", "・・川梵(・)・ｼ・・尖劇・・攪 ・・｢・ｲｽ嵭們ｹ俯導・・嶹菩攤﨑ｩ・壱共"))
;・壱･豸郁ｲｻ
SIF TARGET >= 0
;OriginalString : (HTMLBUTTON("[102] - ・壱･・・・誤ｹ・復・､", "102", "・壱･繧剃ｽｿ縺｣縺ｦ繧｢繧､繝・Β繧・・蜉帷ｭ峨・・ｨ・昴∵眠縺溘↑・・川梵縺ｮ霑ｽ蜉繧定｡後＞縺ｾ縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[102] - ・壱･・・・誤ｹ・復・､", "102", "・壱･・ｼ ・ｬ・ｩ﨑ｴ ・・擽奛懍擽・・・･・･・ｱ・們ｷｨ・・ ・壱｡懍垓・・川梵・・・緋ｰ・ｼ ・､・懦鮒・壱共"))
;・・川梵蛻・ｊ譖ｿ縺・
SIF CHARANUM > 2
;OriginalString : (HTMLBUTTON("[110] - ・・川梵/・ｰ・俯･ｼ ・・ｽ﨑罹共", "110", "迴ｾ蝨ｨ縺ｮ・・川梵/・ｰ・倥ｒ莉悶・・・川梵縺ｫ螟画峩縺励∪縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[110] - ・・川梵/・ｰ・俯･ｼ ・・ｽ﨑罹共", "110", "嶸・椪・們｣・川梵/・ｰ・俯･ｼ ・､・ｸ・・川梵・・・・ｽ﨑ｩ・壱共"))
;・們メ ・､・・
SIF TARGET > 0
;OriginalString : (HTMLBUTTON("[155] - ・們メ ・､・・, "155", "・・川梵縺ｨ・・尖劇・√・・們メ繧定ｨｭ螳壹＠縺ｾ縺・))
	CALL HTMLPRINTL(HTMLBUTTON("[155] - ・們メ ・､・・, "155", "・・川梵(・)・ｼ・・尖劇・・・・們メ・ｼ ・､・倣鮒・壱共"))
;繝・・繧ｿ繝吶・繧ｹ
;OriginalString : (HTMLBUTTON("[177] - ・ｰ・ｴ奓ｰ・・ｴ・､ ・ｴ・ｰ", "177", "蜷・ｨｮ・・舌ョ繝ｼ繧ｿ繧堤｢ｺ隱阪＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[177] - ・ｰ・ｴ奓ｰ・・ｴ・､ ・ｴ・ｰ", "177", "・・｢・｣・尖魂・ｴ奓ｰ・ｼ 嶹菩攤﨑ｩ・壱共"))
;繧ｳ繝ｳ繝輔ぅ繧ｰ
;OriginalString : (HTMLBUTTON("[178] - ・ｬ・ｱ", "178", "繧ｲ繝ｼ繝縺ｮ險ｭ螳壹ｒ陦後＞縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[178] - ・ｬ・ｱ", "178", "・護桷・・・､・菩揆 ・､・懦鮒・壱共"))
;・ｸ・ｴ・・
;OriginalString : (HTMLBUTTON("[200] - ・ｸ・ｴ・・, "200", "迴ｾ蝨ｨ縺ｮ繝・・繧ｿ繧剃ｿ晏ｭ倥＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[200] - ・ｸ・ｴ・・, "200", "嶸・椪・・・ｰ・ｴ奓ｰ・ｼ ・ｴ・ｴ﨑ｩ・壱共"))
;・罹糖
;OriginalString : (HTMLBUTTON("[300] - ・罹糖", "300", "菫晏ｭ倆毎・､繝・・繧ｿ繧定ｪｭ縺ｿ霎ｼ縺ｿ縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[300] - ・罹糖", "300", "・ｴ・ｴ嵂壱共・ｰ・ｴ奓ｰ・ｼ ・ｽ・ｴ・､・・笈・､"))

;Emuera・罷ｲ・ｷｸ・ｨ・懆ｵｷ蜍墓凾
[IF_DEBUG]
{
;OriginalString : (HTMLBUTTON("[777] - ・罷ｲ・ｷｸ・ｨ・・ + (FLAG:・罷ｲ・ｷｸ ? "・ｼ ・・｣・ # ""), "777", 
	CALL HTMLPRINTL(HTMLBUTTON("[777] - ・罷ｲ・ｷｸ・ｨ・・ + (FLAG:・罷ｲ・ｷｸ ? "・ｼ ・・｣・ # ""), "777", 
		FLAG:・罷ｲ・ｷｸ ? "奝ｵ・・剩・ｴ・ｼ・・・護符・瀧笈・､" # "・・・・罷ｲ・ｷｸ・ｨ・罹･ｼ ・ｬ・ｩ﨑ｩ・壱共"))
}
	IF FLAG:・罷ｲ・ｷｸ
		PRINTFORML \n--・罷ｲ・ｷｸ ・､・俯糖・・・・失﨑俾ｲ・・・勦・・・緋ｿ ・・・醐⊂)・・・・紛・・・誤ｬｸ・・ ・誤豆・溢愍・・・\n・ｴ﨑們攪 ・､・俯糖・・・倆復 ・ｴ・・捩 ・呷梠 ・ｴ・･・ｸ・・﨑ｩ・壱共--\n
		;・壱･蠅怜刈
		SIF TARGET >= 0
;OriginalString : (HTMLBUTTON("[778] - ・壱･蠅怜刈", "778", "・・川梵縺ｮ・壱･繧貞｢励ｄ縺励∪縺・))
			CALL HTMLPRINTL(HTMLBUTTON("[778] - ・壱･・晝ｰ", "778", "・・川梵・ｸ・壱･・ｼ ・俯ｦｽ・壱共"))
		;霆｢逕溘・蜆蠑・
;OriginalString : (HTMLBUTTON("[779] - 霆｢逕溘・蜆蠑・, "779", "嵓誤溢擽繝､繝ｼ繧ｭ繝｣繝ｩ縺ｮ蜀崎ｨｭ螳夂判髱｢縺ｸ騾ｲ縺ｿ縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[779] - ・・・・・・們享", "779", "嵓誤溢擽・ｼ・尖攵・・・ｬ・､・・嶹罷ｩｴ・ｼ・・・們符・瀧笈・､"))
		;嵓誤椈・ｸ繝√ぉ繝・け
;OriginalString : (HTMLBUTTON("[780] - 嵓誤椈・ｸ繝√ぉ繝・け", "780", "CFLAG縺ｨFLAG縺ｮ迥ｶ豕√ｒ遒ｺ隱阪＠縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[780] - 嵓誤椈・ｸ・ｴ增ｬ", "780", "CFLAG(・)・ｼFLAG・・・・勦・・嶹菩攤﨑ｩ・壱共"))
		;・､奝・ｨ・・
;OriginalString : (HTMLBUTTON("[781] - ・､奝・ｨ・・, "781", "・・尖劇・√・嵂雅徐繧定・蜍輔〒陦後≧・ｨ・懊・險ｭ螳夂判髱｢繧貞他縺ｳ蜃ｺ縺励∪縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[781] - ・､奝・ｨ・・, "781", "・・尖劇・・・嵂雅徐・ｼ ・尖徐・ｼ・・・､・懦復・､・ｨ・懍攪 ・､・・嶹罷ｩｴ・・嶸ｸ・懦鮒・壱共"))
		;邏雉ｪ・ｴ・慕｢ｺ隱・
;OriginalString : (HTMLBUTTON("[782] - 邏雉ｪ・ｴ・慕｢ｺ隱・, "782", "蜷・く繝｣繝ｩ縺ｮ繧ｳ繝槭Φ繝餓│夋晝ｲｽ嵂･繧堤｢ｺ隱阪＠縺ｾ縺・))
		CALL HTMLPRINTL(HTMLBUTTON("[782] - ・護ｧ壱ｳｴ・倣剳・ｸ", "782", "・・・尖ｦｭ奓ｰ・・・､・ｨ・懍│夋晝ｲｽ嵂･・ｼ 嶹菩攤﨑ｩ・壱共"))
	ENDIF
[ENDIF]

PRINTL 
;OriginalString : (HTMLBUTTON("[888] - ・ｬ・・像・懍└・・, "888", "・ｬ・√・陦ｨ遉ｺ/髱櫁｡ｨ遉ｺ繧定ｨｭ螳壹＠縺ｾ縺・))
CALL HTMLPRINTL(HTMLBUTTON("[888] - ・ｬ・・像・懍└・・, "888", "・ｬ・・攪 岺懍亨/・・像・罹･ｼ ・､・倣鮒・壱共"))
DRAWLINE


;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｷ繝ｧ繝・・繝｡繝九Η繝ｼ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@USERSHOP
IF RESULT == 100 && TARGET >= 0
	BEGIN TRAIN
	RETURN 1
ELSEIF RESULT == 101
	CALL SHOW_CHARADATA
ELSEIF RESULT == 102 && TARGET >= 0
	CALL BONUS_GAIN
	RETURN 1
ELSEIF RESULT == 110 && CHARANUM > 2
	CALL CHANGE_TARGET_ASSI
ELSEIF RESULT == 155 && TARGET >= 0
	CALL CLOTHES_SETTING
ELSEIF RESULT == 177
	CALL DATABASE_OUTPUT
ELSEIF RESULT == 178
	CALL CONFIGURE
ELSEIF RESULT == 200
	;SAVEGAME
	;竊担YSTEM_DATAMENU.ERB
	CALL DATAMENU("SAVE")
ELSEIF RESULT == 300
	;LOADGAME
	;竊担YSTEM_DATAMENU.ERB
	CALL DATAMENU("LOAD")
ELSEIF RESULT == 888
	CALL KOJO_SET
ENDIF
;Emuera・罷ｲ・ｷｸ・ｨ・懆ｵｷ蜍墓凾
[IF_DEBUG]
	IF 0
	ELSEIF RESULT == 777
		PRINTFORML ・罷ｲ・ｷｸ・ｩ・・・肥┷・・ｼ 岺懍亨\@ FLAG:・罷ｲ・ｷｸ ? 縺励↑縺・# 縺吶ｋ \@・呟ｲ・・､・倣毎・ｵ・壱共
		FLAG:・罷ｲ・ｷｸ = !FLAG:・罷ｲ・ｷｸ ? 1 # 0
		WAIT
	ELSEIF RESULT == 778 && FLAG:・罷ｲ・ｷｸ && TARGET >= 0
		CFLAG:・壱･ += 10000
		PRINTFORML %CALLNAME%・・・壱･+10000・們来・ｵ・壱共
		WAIT
	ELSEIF RESULT == 779 && FLAG:・罷ｲ・ｷｸ
		PRINTW ・ｰ・・・・・ｼ溢｣ｼ・ｸ・ｵ・・・・・ｼ ・ｬ・､・倣腹 ・・・溢慣・壱共
		CALL MASTER_CUSTOM
		CALL BASE_MASTER_SETUP
	ELSEIF RESULT == 780 && FLAG:・罷ｲ・ｷｸ
		CALL FLAGCHECK
	ELSEIF RESULT == 781 && FLAG:・罷ｲ・ｷｸ
		CALL SET_AUTO
	ELSEIF RESULT == 782 && FLAG:・罷ｲ・ｷｸ
		CALL CHECK_TALENT_CRI
	ENDIF
[ENDIF]


@KOJO_SET
PRINTL ・尖ｦｭ奓ｰ ・川揆 ・ｴ・ｻ・・岺懍亨﨑ｩ・一ｹ鯉ｼ・
PRINTL [0] - 岺懍亨OFF
PRINTL [1] - 岺懍亨ON縲窶ｻ・肥ｲ・
$INPUT_LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		PRINTW ・尖ｦｭ奓ｰ ・川揆 岺懍亨﨑們ｧ ・喜慣・壱共
	CASE 1
		PRINTW ・尖ｦｭ奓ｰ ・川揆 岺懍亨﨑ｩ・壱共
	CASEELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
ENDSELECT
FLAG:・ｬ・・= RESULT
PRINTL 

;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;・・川梵/・ｰ・伜､画峩
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@CHANGE_TARGET_ASSI
#DIM OLD_T, 3

OLD_T = TARGET, (ASSI:1), (ASSI:2)

$CHANGE_LOOP
PRINTFORML ・ｰ・川梵/・ｰ・俯･ｼ ・・ｽ﨑 ・・・溢慣・壱共
CALL KOJO_COLOR(TARGET)
PRINTBUTTON @"[  0] ・ｰ・川梵 - \@ TARGET >= 0 ? [{TARGET,2}] %CALLNAME:TARGET% # ・ｰ・川梵・・・・慣・壱共 \@", 0
PRINTL 
RESETCOLOR
CALL KOJO_COLOR(ASSI:1)
PRINTBUTTON @"[  1] ・ｰ・・  - \@ ASSI:1 >= 0 ? [{ASSI:1,2}] %CALLNAME:(ASSI:1)% # ・ｰ・・(・)・・・・慣・壱共 \@", 1
PRINTL 
IF CHARANUM > 3
	RESETCOLOR
	CALL KOJO_COLOR(ASSI:2)
	PRINTBUTTON @"[  2] ・ｰ・・  - \@ ASSI:2 >= 0 ? [{ASSI:2,2}] %CALLNAME:(ASSI:2)% # ・ｰ・・(・)・・・・慣・壱共 \@", 2
	PRINTL 
ENDIF
IF TARGET < 0
	SETCOLOR 160, 160, 160
	PRINTFORML [---] ・ｰ・川梵・ｼ ・ｰ・倣紛 ・ｼ・ｸ・・
	RESETCOLOR
ELSE
	RESETCOLOR
	PRINTFORML [  9] ・・ｽ ・・｣・
ENDIF
$INPUT_LOOP
INPUT
SELECTCASE RESULT
	CASE 0
		CALL CHANGE_TARGET
		GOTO CHANGE_LOOP
	CASE 1
		CALL CHANGE_ASSI(1)
		GOTO CHANGE_LOOP
	CASE 2
		IF CHARANUM > 3
			CALL CHANGE_ASSI(2)
			GOTO CHANGE_LOOP
		ENDIF
	CASE 9
		IF TARGET >= 0
			;・ｰ・・縺檎ｩｺ縺ｮ蝣ｴ蜷医・｡ｰ・・繧廷｡ｰ・・縺ｨ縺吶ｋ
			SIF ASSI:1 == -1
				SWAP ASSI:1, ASSI:2
			CALL CHANGE_TARGET_ASSI_MESSAGE(OLD_T)
			RETURN RESULT
		ENDIF
ENDSELECT
CLEARLINE 1
GOTO INPUT_LOOP

@CHANGE_TARGET_ASSI_MESSAGE(OLD_T)
#DIM LCOUNT
#DIM REF OLD_T, 0
#DIM NEW_T, 3

NEW_T = TARGET, (ASSI:1), (ASSI:2)

;螟画峩縺悟・縺剰｡後ｏ繧後※縺・↑縺・ｴ蜷・
IF OLD_T:0 == NEW_T:0 && OLD_T:1 == NEW_T:1 && OLD_T:2 == NEW_T:2
	;・・川梵縺護｣ｼ・ｸ・倥・蝣ｴ蜷・
	IF TALENT:TARGET:・ｼ・ｸ・・
		PRINTFORMW %CALLNAME:TARGET%(・)・・・ｴ・・・・､・､・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・ｰ・・嵂壱共窶ｦ
	;縺昴ｌ莉･螟・
	ELSE
		PRINTFORMW ・ｴ・・・CALLNAME:TARGET%・・%CALLNAME:MASTER%(・・・ｼ ・ｰ・川亨墲､・ｰ・・嵂壱共窶ｦ
	ENDIF
ENDIF
;・・川梵縺ｮ螟画峩縺瑚｡後ｏ繧後※縺・ｋ蝣ｴ蜷・
IF OLD_T:0 != NEW_T:0
	;・ｬ・√・轤ｺ縺ｫ蟆ら畑螟画焚縺ｫ莠､莉｣蜈・・蜈医・・ｱ・晤ｲ逸从繧貞・繧後ｋ
	SHOP_OLDTARGET = OLD_T:0
	SHOP_NEWTARGET = NEW_T:0
	;譁ｰ・・川梵繧ｫ繝・ヨ繧､繝ｳ
	PRINTL
	CALL CHARA_CUTIN(CSTR:10, CSTR:11, CSTR:・罹ｧ溢梵)
	PRINTL
	;荳譎ら噪縺ｫTARGET繧呈立・・川梵縺ｫ謌ｻ縺・
	TARGET = OLD_T:0
	;譌ｧ・・川梵・ｬ・∝他縺ｳ蜃ｺ縺・
	CALL KOJO_EVENT(102)
	;・ｼ・ｸ・倪・・ｼ・ｸ・倅ｻ･螟悶∈縺ｮ螟画峩
	IF TARGET >= 0 && TALENT:TARGET:・ｼ・ｸ・・
		PRINTFORMW %CALLNAME:TARGET%(・)・・%CALLNAME:SHOP_NEWTARGET%・・%CALLNAME:MASTER%・・・ｰ・尖･ｼ ・・メ嵂壱共窶ｦ
	;・ｼ・ｸ・倅ｻ･螟問・・ｼ・ｸ・倥∈縺ｮ螟画峩
	ELSEIF TALENT:SHOP_NEWTARGET:・ｼ・ｸ・・
		PRINTFORMW %CALLNAME:SHOP_NEWTARGET%(・)・・・､・､・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・ｰ・・嵂壱共窶ｦ
	;・ｼ・ｸ・倅ｻ･螟問・・ｼ・ｸ・倅ｻ･螟悶∈縺ｮ螟画峩
	ELSE
		PRINTFORMW \@ TARGET >= 0 ? %CALLNAME:TARGET%・・・・﨑ｴ, # \@%CALLNAME:SHOP_NEWTARGET%﨑們ｧ・・CALLNAME:MASTER%(・・・ｼ ・ｰ・戦葺・・・們来・､窶ｦ
	ENDIF
	;TARGET繧呈眠・・川梵縺ｫ
	TARGET = NEW_T:0
	;譁ｰ・・川梵・ｬ・∝他縺ｳ蜃ｺ縺・
	CALL KOJO_EVENT(102, 1)
ENDIF
;譁ｰ・ｰ・伜・蜩｡繧定ｪｿ譟ｻ
FOR LCOUNT, 1, 3
	;・ｰ・廊COUNT縺梧眠隕丈ｻｻ蜻ｽ閠・・蝣ｴ蜷・
	IF FINDLASTELEMENT(OLD_T, NEW_T:LCOUNT, 1) == -1
		;ASSI縺ｫ譁ｰ隕丈ｻｻ蜻ｽ閠・ｒ謖・ｮ・
		ASSI = NEW_T:LCOUNT
		;・ｰ・倅ｻｻ蜻ｽ・ｬ・∝他縺ｳ蜃ｺ縺・
		CALL KOJO_EVENT_ASSI(102)
		CALL VOIDLINE_IF(RESULT)
		;ASSI繧貞・縺ｫ謌ｻ縺・
		ASSI = ASSI:1
	ENDIF
NEXT

;・・川梵・夋・
@CHANGE_TARGET(ARG)
LOCALS = 
LOCALS += "<隴伜挨>CHANGE_TARGET"
LOCALS += "<荳企Κ>CHANGE_TARGET_SHOW"
LOCALS += "<譚｡莉ｶ>CHANGE_TARGET_REQU"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += ARG ? "<蜿匁ｶ・・ｨ・御ｸ榊庄" # "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
SIF RESULT != -1
	CALL SET_TARGET_ASSI(TARGET, 0, RESULT)

@CHANGE_TARGET_SHOW
PRINTFORML 嶸・椪 \@ TARGET >= 0 ? [{TARGET,2}] %CALLNAME:TARGET%・ ・ｰ・川､・# ・ｰ・川梵・・・・慣・壱共 \@
PRINTL ・ｴ・・・ｰ・川梵・・・・ｵｬ・・笈・鯉ｼ・

@CHANGE_TARGET_REQU(ARG)
RETURN ARG == 0 ? 0 # 1

;・ｰ・們│夋・
@CHANGE_ASSI(ARG)
LOCALS = 
LOCALS += "<隴伜挨>CHANGE_TARGET"
LOCALS += @"<荳企Κ>CHANGE_ASSI_SHOW_{ARG}"
LOCALS += "<譚｡莉ｶ>CHANGE_TARGET_REQU"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += "<・夋・CHANGE_ASSI_CHOI"
LOCALS += "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
IF RESULT != -1
	SIF RESULT == -2
		RESULT = -1
	CALL SET_TARGET_ASSI(ASSI, ARG, RESULT)
ENDIF

@CHANGE_ASSI_SHOW_1
CALL CHANGE_ASSI_SHOW(1)
@CHANGE_ASSI_SHOW_2
CALL CHANGE_ASSI_SHOW(2)
@CHANGE_ASSI_SHOW(ARG)
IF ASSI:1 >= 0
	PRINTFORML 嶸・椪 [{ASSI:1,3}] %CALLNAME:(ASSI:1)%\@ ASSI:2 >= 0 ? 縲ー{ASSI:2,3}] %CALLNAME:(ASSI:2)% # \@縺護｡ｰ・・
ELSE
	PRINTL 嶸・椪 ・ｰ・俯株 ・・慣・壱共
ENDIF
PRINTFORML ・ｴ・・・ｰ・・ARG}(・)・・・・ｵｬ・・笈・鯉ｼ・
PRINTFORML 縲[0]縲護螺・後坂ｻ・ｰ・・ARG}(・・・ｼ ・・倣葺・ ・喜慣・壱共

@CHANGE_ASSI_CHOI(ARGS)
IF ARGS == "0"
	RESULTS '= "-2"
	RETURN 0
ENDIF
RETURN 1

;・・川梵/・ｰ・倥・莉ｻ蜻ｽ縺ｫ蠢懊§縺ｦ驕ｩ螳懃焚蜍輔・隗｣莉ｻ繧定｡後≧
@SET_TARGET_ASSI(LREF, ARG, ARG:1)
#DIM REF LREF,0
;蜑堺ｻｻ閠・→蠖ｹ蜑ｲ縺ｮ莠､謠帙ｒ陦後≧
LOCAL = LREF:ARG
IF ARG:1 != -1
	TARGET = TARGET == ARG:1 ? LOCAL # TARGET
	ASSI:1 = ASSI:1 == ARG:1 ? LOCAL # ASSI:1
	ASSI:2 = ASSI:2 == ARG:1 ? LOCAL # ASSI:2
ENDIF
;蠖ｹ蜑ｲ縺ｮ莉ｻ蜻ｽ繧定｡後≧
LREF:ARG = ARG:1
;ASSI繧定ｨｭ螳・
ASSI = ASSI:1

;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繧ｭ繝｣繝ｩ縺ｮ繧ｹ繝・・繧ｿ繧ｹ陦ｨ遉ｺ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@SHOW_CHARADATA(ARG)
LOCALS = 
LOCALS += "<隴伜挨>SHOW_CHARADATA"
LOCALS += "<・ｬ・・・・川梵"
LOCALS += "<蜿匁ｶ・・護符・・ｰ"
LOCALS += "<鬆・岼>蜷榊燕/・ｴ・･繝ｻ・ｰ・･/・ｽ嵭們ｹ・
CALL SELECT_CHARA_LIST(LOCALS)
;・護符・・ｰ・夋晄凾閼ｱ蜃ｺ
SIF RESULT < 0
	RETURN 0
LOCAL = RESULT
;繧ｹ繝・・繧ｿ繧ｹ陦ｨ遉ｺ
CALL PRINT_STATUS(RESULT)
;蜀肴緒逕ｻ
RESTART

@SHOW_CHARADATA_PAD
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM L_SELECT
#DIM L_CHARA, 4
#DIM LINE
LINE = LINECOUNT
L_SELECT = 0
L_CHARA = MASTER, TARGET, ASSI:1, ASSI:2
$START
CLEARLINE LINECOUNT - LINE

DRAWLINE
FOR LOCAL, 0, 4
	SIF L_CHARA:LOCAL == -1
		CONTINUE
	SIF LOCAL == L_SELECT
		SETCOLOR 0x7070C0
	LOCALS = 
	LOCALS += @" %CALLNAME:LOCAL,16,LEFT% ・ｴ・･({MAX(BASE:LOCAL:0,0),4}/{MAXBASE:LOCAL:0,4}) "
	LOCALS += @" [LV {CFLAG:LOCAL:0,2} NEXT {CFLAG:LOCAL:﨑・囈・ｽ嵭們ｹ・- CFLAG:LOCAL:1,6}]"
	LOCALS += AUTO_SPLIT("_・・川梵_・ｰ・假ｼ狙・ｰ・假ｼ・, "_", LOCAL)
	SIF TALENT:(L_CHARA:LOCAL):・ｼ・ｸ・・
		LOCALS += "<・ｼ・ｸ・・"
	PRINTBUTTON LOCALS, UNICODE(10000 + LOCAL)
	RESETCOLOR
	PRINTL 
	SIF LOCAL == 0
		DRAWLINE
NEXT
DRAWLINE
PRINTBUTTON "[" + KEYMARK_B+ "] - ・護符・ｨ・､", KEY_B
ONEINPUTS
SELECTCASE RESULTS
	CASE KEY_A
		CALL PRINT_STATUS, L_CHARA:L_SELECT
	CASE KEY_B
		RETURN 0
	CASE KEY_UP
		DO 
			SIF --L_SELECT == -1
				L_SELECT = 3
		LOOP L_CHARA:L_SELECT == -1
	CASE KEY_DOWN
		L_SELECT++
		SIF L_CHARA:L_SELECT == -1
			L_SELECT = 0
ENDSELECT
GOTO START
@FLAGCHECK
PRINTL [0] - ・護符・ｨ・､
PRINTL [1] - FLAG
PRINTL [2] - CFLAG
PRINTL [3] - FLAG・・・､嵓・
PRINTL [4] - CFLAG・・・､嵓・
$INPUT_LOOP1
INPUT
SELECTCASE RESULT
	CASE 0
	CASE 1
		VARSIZE FLAG
		LOCAL = RESULT
		PRINTFORML FLAG・逸从(0・桀LOCAL-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP2
		INPUT
		IF RESULT < 0 || LOCAL <= RESULT
			CLEARLINE 1
			REUSELASTLINE FLAG縺ｮ遽・峇縺ｯ(0・桀LOCAL-1})縺ｧ縺吶・
			GOTO INPUT_LOOP2
		ENDIF
		PRINTFORMW FLAG:{RESULT} = {FLAG:RESULT}
		RESTART
	CASE 2
		PRINTFORML ・・・・尖ｦｭ奓ｰ・・・ｱ・・・逸从(0・桀CHARANUM-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP3
		INPUT
		IF RESULT < 0 || CHARANUM <= RESULT
			CLEARLINE 1
			REUSELASTLINE 蟄伜惠縺励∪縺帙ｓ縲・
			GOTO INPUT_LOOP3
		ENDIF
		LOCAL = RESULT
		VARSIZE CFLAG
		LOCAL:1 = RESULT
		PRINTFORML %CALLNAME:LOCAL%﨑們ｧ・・・夋晤据・溢慣・壱共.
		PRINTFORML CFLAG・逸从(0・桀LOCAL:1-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP4
		INPUT
		IF RESULT < 0 || LOCAL:1 <= RESULT
			CLEARLINE 1
			REUSELASTLINE CFLAG縺ｮ遽・峇縺ｯ(0・桀LOCAL:1-1})縺ｧ縺・
			GOTO INPUT_LOOP4
		ENDIF
		PRINTFORMW %CALLNAME:LOCAL%・呂FLAG:{RESULT} = {CFLAG:LOCAL:RESULT}
		RESTART
	CASE 3
		PRINTL FLAG・ｼ・・・廷擽0・・・・捩 ・晤楫)
		FOR LOCAL, 0, VARSIZE("FLAG")
			SIF FLAG:LOCAL
				PRINTFORMLC [FLAG:{LOCAL,4}={FLAG:LOCAL,10}]
		NEXT
		WAIT
		RESTART
	CASE 4
		PRINTFORML ・・・・尖ｦｭ奓ｰ・・・ｱ・・・逸从(0・桀CHARANUM-1})(・・・ｼ ・・･﨑ｴ ・ｼ・ｸ・・
		$INPUT_LOOP5
		INPUT
		IF RESULT < 0 || CHARANUM <= RESULT
			CLEARLINE 1
			REUSELASTLINE 蟄伜惠縺励∪縺帙ｓ縲・
			GOTO INPUT_LOOP5
		ENDIF
		PRINTFORML %CALLNAME:RESULT%・呂FLAG・ｼ・・・廷擽0・・・・捩 ・晤楫)
		FOR LOCAL, 0, VARSIZE("CFLAG")
			SIF CFLAG:RESULT:LOCAL
				PRINTFORMLC [CFLAG:{LOCAL,4}={CFLAG:RESULT:LOCAL,10}]
		NEXT
		WAIT
		RESTART
	CASEELSE
		CLEARLINE 1
		GOTO INPUT_LOOP1
ENDSELECT

@SET_AUTO
#DIM SELECT
#DIM LINE
#DIMS 繧ｻ繝・ヨ蜷・ 5
#LOCALSSIZE 100
REDRAW 0
SELECT = -1
VARSET LOCALS
LINE = LINECOUNT
FOR LOCAL, 0, 5
	SIF !STRCOUNT(GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}", "_")
		GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}" = ・ｱ・掉LOCAL}_%GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}"%
	SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉LOCAL}", "_", RESULTS
	繧ｻ繝・ヨ蜷・LOCAL = %RESULTS%
NEXT
SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
SPLIT RESULTS:1, "/", LOCALS
$START
;蜑企勁繧ｳ繝槭Φ繝牙所縺ｳ・ｴ・∝､縺ｮ繝√ぉ繝・け
FOR LOCAL, 0, 100
	SIF LOCALS:LOCAL == ""
		CONTINUE
	SIF GETNUM(TRAINNAME, LOCALS:LOCAL) >= 0 || LOCALS:LOCAL == "・ｴ・ｨ・罷劇・・
		CONTINUE
	ARRAYREMOVE LOCALS, LOCAL, 1
	LOCAL--
NEXT
;遨ｺ陦後・謨ｴ逅・
FOR LOCAL, 0, 100 - MATCH(LOCALS, "")
	SIF LOCALS:LOCAL != ""
		CONTINUE
	ARRAYREMOVE LOCALS, LOCAL, 1
	LOCAL--
NEXT
;譁ｰ隕剰ｿｽ蜉蜿危胸嵂壱共繧ｳ繝槭Φ繝峨・繝√ぉ繝・け
FOR LOCAL, 0, 100
	SIF TRAINNAME:LOCAL == ""
		CONTINUE
	;莉墓ｧ倅ｸ器・・・│夋昴〒縺阪ｋ縺ｨ蝠城｡後′縺ゅｋ縺ｮ縺ｧ繧ｫ繝・ヨ縺励※縺翫￥
	SIF TRAINNAME:LOCAL == "・ｴ・ｨ・罷劇・・
		CONTINUE
	SIF FINDELEMENT(LOCALS, TRAINNAME:LOCAL) >= 0
		CONTINUE
	LOCALS:(100 - MATCH(LOCALS, "")) = %TRAINNAME:LOCAL%
NEXT
CLEARLINE LINECOUNT - LINE
DRAWLINE
PRINTBUTTON @"・､奝・ｨ・・%\@FLAG:・､奝・ｨ・・> 0?・ｯ・ｮ#・ｯ・ｦ・ｦ\@%>", 1000
IF FLAG:・､奝・ｨ・・> 0
	PRINT 縲
	PRINTBUTTON @"・ｽ・ｼ繧ｿ繝ｼ繝ｳ謨ｰ<{FLAG:・､奝・ｨ・怡>", 1001
ENDIF
PRINTL 
DRAWLINE
PRINTFORML <%繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ)%>
FOR LOCAL, 0, 100
	SIF LOCALS:LOCAL == ""
		BREAK
	SIF LOCAL == SELECT
		SETCOLOR 0xC07070
	PRINTBUTTON @"%"["+LOCALS:LOCAL+"]",24,LEFT% > ", LOCAL
	SIF LOCAL % 4 == 3
		PRINTL 
	RESETCOLOR
NEXT
PRINTL 
DRAWLINE
PRINTL <・ｸ孖ｸ>
FOR LOCAL, 0, 5
	SIF LOCAL == FLAG:・夋晧┷孖ｸ
		SETCOLOR 0xC07070
	PRINTBUTTON @"%"["+繧ｻ繝・ヨ蜷・LOCAL+"]",25,LEFT%", 2000 + LOCAL
	RESETCOLOR
	SIF LOCAL % 3 == 2
		PRINTL 
NEXT
SIF !LINEISEMPTY()
	PRINTL 
DRAWLINE
PRINTL <・ｸ孖ｸ ・ｰ・・
PRINTBUTTON "[・・ｹｭ ・・ｽ]縲", 2010
PRINT 縲
PRINTBUTTON "[・ｱ・拆縲縲", 2011
PRINT 縲
PRINTBUTTON "[・ｬ・駈敢]", 2012
PRINTL 
DRAWLINE
PRINTL <・被抄孖ｸ ・ｸ孖ｸ>
PRINTBUTTON "[・逸从・懍・]縲縲", 2020
PRINT 縲
PRINTBUTTON "[・懍｢・縲縲", 2021
PRINT 縲
PRINTBUTTON "[・倆墳・‐縲", 2022
PRINTL 
DRAWLINE
PRINTL <岺懍亨 ・､・・
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 0
	SETCOLOR 0xC07070
PRINTBUTTON "[奝ｵ・‐縲縲", 2030
RESETCOLOR
PRINT 縲
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 1
	SETCOLOR 0xC07070
PRINTBUTTON "[・・楫]縲縲", 2031
PRINT 縲
RESETCOLOR
SIF FLAG:・､奝・ｨ・懦像・懍└・・== 2
	SETCOLOR 0xC07070
;PRINTBUTTON "[・罷ｲ・ｷｸ髱櫁｡ｨ遉ｺ]", 2032
RESETCOLOR
PRINTL 
DRAWLINE
PRINTL <・ｰ・ ・・護｡ｱ ・ｴ・溢侃>
PRINTBUTTON "["+AUTO_SPLIT("・ｸ・罹ｘ ・・・・ｴ・川揆 ・ｴ・ｭ嶸/・母ｳ・・ｰ・ｬ・ｼ・/・ｩ・ｬ﨑俾ｲ・﨑ｴ/・卓・・・ｬ・・﨑ｴ/・晝ｰ・・・語ｹ護ｧ 﨑ｴ/・野乱 ・俾ｰ・ ・ｶ・､/・餓┷・/・ｬ・・﨑ｴ/・一ｸｰ・ ・ｶ・､/・餓ぎ﨑俾ｳ ・ｶ・､/・・ｬ・醐紛/・罹墾", "/", FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 % 100)+"]", 3000
PRINTL 
PRINTBUTTON "["+AUTO_SPLIT("・ｸ・罹ｘ ・・・・ｴ・川揆 ・ｴ・ｭ嶸/・母ｳ・・ｰ・ｬ・ｼ・/・ｩ・ｬ﨑俾ｲ・﨑ｴ/・卓・・・ｬ・・﨑ｴ/・晝ｰ・・・語ｹ護ｧ 﨑ｴ/・野乱 ・俾ｰ・ ・ｶ・､/・餓┷・/・ｬ・・﨑ｴ/・一ｸｰ・ ・ｶ・､/・餓ぎ﨑俾ｳ ・ｶ・､/・・ｬ・醐紛/・罹墾", "/", FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100)+"]", 3001
PRINTL (・壱ｹ・
DRAWLINE
PRINTBUTTON "[・護符・ｨ・､]", 999
INPUT
SELECTCASE RESULT
	CASE 2000 TO 2004
		IF FLAG:・夋晧┷孖ｸ != RESULT - 2000
			FLAG:・夋晧┷孖ｸ = RESULT - 2000
			SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
			SPLIT RESULTS:1, "/", LOCALS
		ENDIF
	CASE 2010
		PRINTL ・・ｹｭ・・・・･﨑ｴ ・ｼ・ｸ・・
		INPUTS
		SIF RESULTS == ""
			RESULTS = ・ｱ・掉FLAG:・夋晧┷孖ｸ}
		繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ) = %RESULTS%
	CASE 2011, 999
		PRINTW 嶸・椪・ｸ孖ｸ・ｼ ・ｱ・晨鮒・壱共
		GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" = %繧ｻ繝・ヨ蜷・(FLAG:・夋晧┷孖ｸ)%_
		FOR LOCAL, 0, 100 - MATCH(LOCALS, "")
			SIF LOCALS:LOCAL == ""
				BREAK
			GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" += LOCALS:LOCAL
			GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" += "/"
		NEXT
		;譛ｫ蟆ｾ縺ｮ蛹ｺ蛻・ｊ險伜捷繧貞炎繧・
		GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}" = %SUBSTRING(GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", 0, STRLENS(GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}") - 1)%
		SAVEGLOBAL
		IF RESULT == 999
			CALL AUTO_MODE, 1
			REDRAW 1
			RETURN 0
		ENDIF
	CASE 2012
		SPLIT GLOBALS:@"・､奝・ｨ・罹導・掉FLAG:・夋晧┷孖ｸ}", "_", RESULTS
		SPLIT RESULTS:1, "/", LOCALS
	CASE 2020
		VARSET LOCALS
	CASE 2021
		VARSET LOCALS
		LOCALS += "・・菩揆 ・ｴ・・﨑罹共/嵭壱ｦｬ・ｼ 彧罷蕩・､/・・醐紛・假ｼ・・溢乱 ・ｴ!/・・ｷｹ・・愍・・﨑罹共/・語ｰ川揆 ・幗符・､・ｸ・､/・ｰ・・｢苦ｲ・﨑ｴ/・・Η﨑俾ｲ・・瀧況﨑罹共/・・﨑俯糖﨑俾ｲ・﨑ｴ/"
		LOCALS += "・語ｷｹ・・愍・・﨑罹共/・ｩ・罹･ｼ ・誤共/・・・洳・醐復・､/・溢搆 ・ｽ﨑俾ｲ・・瀧況﨑罹共/・ｨ・ｵ﨑罹共/・ｴ・晤圄﨑俾ｲ・・瀧況﨑罹共/・倣葺・・・瀧況﨑罹共/・溢母ｱｰ・ｰ・､/・語ｰ川揆 ・ｸ・罷共/"
		LOCALS += "・・ｪ・ｧ・ｸ・､/・奝ｵ・・・ｸ・罷共/・川怱・ｼ ・懍梠﨑罹共/・ｫ・ｴ﨑罹共/・懦握・ｴ・､・ ・ｨ・倣復・､/・・螺・ｴ ・・株・､/・ｴ・懍寥﨑罹共/"
		LOCALS += "・溢乱 ・ｴ・ｴ ・壱松!/・ｰ・﨑罹共/・・ｴ・､/・・ｵｬ・ｼ ・懋ｱｰ﨑罹共"
		SPLIT LOCALS, "/", LOCALS
	CASE 2022
		VARSET LOCALS
		LOCALS += "・・ｴ・､/・・ｵｬ・ｼ ・懋ｱｰ﨑罹共/・ｰ・﨑罹共/・溢乱 ・ｴ・ｴ ・壱松!/"
		LOCALS += "・懦握・ｴ・､・ ・ｨ・倣復・､/・ｫ・ｴ﨑罹共/・・螺・ｴ ・・株・､/・・ｪ・ｧ・ｸ・､/・奝ｵ・・・ｸ・罷共/・川怱・ｼ ・懍梠﨑罹共/・ｴ・懍寥﨑罹共/"
		LOCALS += "・語ｷｹ・・愍・・﨑罹共/・ｩ・罹･ｼ ・誤共/・・・洳・醐復・､/・溢搆 ・ｽ﨑俾ｲ・・瀧況﨑罹共/・ｨ・ｵ﨑罹共/・ｴ・晤圄﨑俾ｲ・・瀧況﨑罹共/・倣葺・・・瀧況﨑罹共/・溢母ｱｰ・ｰ・､/・語ｰ川揆 ・ｸ・罷共/"
		LOCALS += "・溢乱 ・ｴ!/・・ｷｹ・・愍・・﨑罹共/・語ｰ川揆 ・幗符・､・ｸ・､/・ｰ・・｢苦ｲ・﨑ｴ/・・Η﨑俾ｲ・・瀧況﨑罹共/・・﨑俯糖﨑俾ｲ・﨑ｴ/・・菩揆 ・ｴ・・﨑罹共/嵭壱ｦｬ・ｼ 彧罷蕩・､/・・醐紛・假ｼ・
		SPLIT LOCALS, "/", LOCALS
	CASE 2030, 2031, 2032
		FLAG:・､奝・ｨ・懦像・懍└・・= RESULT - 2030
	CASE 3000
		IF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 % 100 == 12
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 -= 12
		ELSE
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃++
		ENDIF
	CASE 3001
		IF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100 == 12
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 -= 900
		ELSEIF FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 / 100 == 5
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 += 300
		ELSE
			FLAG:・ｰ・・・護｡ｱ・ｴ・溢侃 += 100
		ENDIF
		
	CASE 1001
		IF FLAG:・､奝・ｨ・・> 0
			CALL INPUT_MANY, 1, 100
			FLAG:・､奝・ｨ・・= RESULT
		ENDIF
	CASE 1000
		IF !FLAG:・､奝・ｨ・・
			FLAG:・､奝・ｨ・・= 1
		ELSE
			FLAG:・､奝・ｨ・・*= -1
		ENDIF
	CASEELSE
		IF SELECT == -1
			SELECT = RESULT
		ELSE
			SWAP LOCALS:SELECT, LOCALS:RESULT
			SELECT = -1
		ENDIF
ENDSELECT
GOTO START

@CHECK_TALENT_CRI
#LOCALSIZE 10
#LOCALSSIZE 200
#DIM LINE
#DIM LINENUM, 2
#DIM LCHARANUM
#DIM LMASTER
#DIM LTARGET
#DIM LTEMP
#DIMS LTEMPS

#DIM LVAR, 30
#DIM LSEX_CRI, 30
#DIM LMAIDEN_CRI, 30

#DIM LTALENT_CRI_EX, 1000
#DIM LTALENT_MENU_CRI, 1000, 20
#DIM LTALENT_CRI, 1000, 20, 30

#DIMS LSEX_OPTION
#DIM LFAVOR_OPTION
#DIM LMAIDEN_OPTION
#DIM LFUTANARI_OPTION

LCHARANUM = CHARANUM
LMASTER = MASTER
LTARGET = TARGET
LINENUM = 15, 35

LSEX_OPTION = 諤ｧ蛻･辟｡隕・
LMAIDEN_OPTION = 1

VARSET LTALENT_MENU_CRI:0:0
VARSET LTALENT_CRI:0:0:0
FOR LOCAL, 0, VARSIZE("TALENT")
	SIF TALENTNAME:LOCAL == ""
		CONTINUE
	ADDVOIDCHARA
	TARGET = CHARANUM - 1
	TALENT:LOCAL = 1
	;螟画焚繧貞・譛溷喧
	CALL SET_CRI_VAR
	FOR LOCAL:1, 0, 11
		;弴ｴ・昴ｒ縺ｯ縺倥￥
		;・ｬ・ｭ縺ｯ蜃ｦ逅・＠縺ｪ縺・
		SIF LOCAL:1 == 8 || LOCAL:1 == 9
			CONTINUE
		CALL SET_CRI_VAR, MENU(LOCAL:1), 1
	NEXT
	CALL ACT_MENU_TALENT_T
	VARSET LVAR
	VARSET RESULT
	CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
	FOR LOCAL:1, 0, 20
		LTALENT_MENU_CRI:LOCAL:(LOCAL:1) += RESULT:(LOCAL:1) * 2
	NEXT
	VARSET RESULT
	CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
	FOR LOCAL:1, 0, 20
		LTALENT_MENU_CRI:LOCAL:(LOCAL:1) += RESULT:(LOCAL:1)
		SIF LTALENT_MENU_CRI:LOCAL:(LOCAL:1)
			LTALENT_CRI_EX:LOCAL = 1
	NEXT
	FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
		CALL RES_CRI_VAR, 1
		CALL ACT_M_INIT(LOCAL:1)
		TRYCCALLFORM ACT_ACTM{LOCAL:1}_TALENT_T
		CATCH
			CONTINUE
		ENDCATCH
		VARSET LVAR
		VARSET RESULT
		CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
		FOR LOCAL:2, 0, 30
			LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2) += RESULT:(LOCAL:2) * 2
		NEXT
		CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
		FOR LOCAL:2, 0, 30
			LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2) += RESULT:(LOCAL:2)
			SIF LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2)
				LTALENT_CRI_EX:LOCAL = 1
		NEXT
	NEXT
	DELCHARA TARGET
NEXT
TARGET= LTARGET
$START
DRAWLINE
LOCALS = 邏雉ｪ隗｣譫・繧ｭ繝｣繝ｩ繧ｯ繧ｿ繝ｼ謖・ｮ・邨ゆｺ・
LOCAL = 0
WHILE AUTO_SPLIT(LOCALS, "/", LOCAL) != ""
	PRINTBUTTON "[" + AUTO_SPLIT(LOCALS, "/", LOCAL) +"]", AUTO_SPLIT(LOCALS, "/", LOCAL) 
	PRINTL 
	LOCAL++
WEND
CALL INPUT_SPLIT, LOCALS
SELECTCASE RESULTS
	CASE "邏雉ｪ隗｣譫・
		$START_TALENT
		LOCALS:1 = 
		LOCAL:1 = 0
		FOR LOCAL, 0, VARSIZE("TALENT") + 2
			IF LOCAL == VARSIZE("TALENT") + 1
				LOCALS:1 += "END"
				PRINTBUTTON @"%"[・護符・ｨ・､]", 16, LEFT%", "END"
			ELSEIF LOCAL == VARSIZE("TALENT")
				LOCALS:1 += "ALL/"
				PRINTBUTTON @"%"[・・・・・", 16, LEFT%", "ALL"
			ELSE
				SIF !LTALENT_CRI_EX:LOCAL
					CONTINUE
				LOCALS:1 += TALENTNAME:LOCAL + "/"
				PRINTBUTTON @"%"[" + TALENTNAME:LOCAL +"]", 16, LEFT%", TALENTNAME:LOCAL
			ENDIF
			SIF LOCAL:1 % 6 == 0
				PRINTL 
			LOCAL:1++
		NEXT
		SIF !LINEISEMPTY()
			PRINTL 
		CALL INPUT_SPLIT, LOCALS:1
		SIF RESULTS == "END"
			GOTO START
		FOR LOCAL, 0, VARSIZE("TALENT")
			IF RESULTS == "ALL"
				SIF !LTALENT_CRI_EX:LOCAL
					CONTINUE
			ELSE
				SIF TALENTNAME:LOCAL != RESULTS
					CONTINUE
			ENDIF
			DRAWLINE
			PRINTFORML %TALENTNAME:LOCAL%
			FOR LOCAL:1, 0, 20
				LTEMP = LTALENT_MENU_CRI:LOCAL:(LOCAL:1)
				SIF !LTEMP
					CONTINUE
				PRINTFORM %MENU(LOCAL:1), 24, LEFT%
				IF LTEMP > 0
					SETCOLOR 0x7070C0
				ELSE
					SETCOLOR 0xC07070
				ENDIF
				PRINTFORML {LTEMP,4}
				RESETCOLOR
			NEXT
			FOR LOCAL:1, 0, 20
				FOR LOCAL:2, 0, 30
					LTEMP = LTALENT_CRI:LOCAL:(LOCAL:1):(LOCAL:2)
					SIF !LTEMP
						CONTINUE
					PRINTFORM %GET_ACTABBNAME(ACTM_NUM(LOCAL:1, LOCAL:2)) + "(" + MENU(LOCAL:1) + ")", 24, LEFT%
					IF LTEMP > 0
						SETCOLOR 0x7070C0
					ELSE
						SETCOLOR 0xC07070
					ENDIF
					PRINTFORML {LTEMP,4}
					RESETCOLOR
				NEXT
			NEXT
		NEXT
		WAIT
		GOTO START_TALENT
	CASE "繧ｭ繝｣繝ｩ繧ｯ繧ｿ繝ｼ謖・ｮ・
		$START_CHARA
		LOCALS:1 = END/・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ/諤ｧ蛻･辟｡隕・・・尖劇・√′逕ｷ/・・尖劇・√′螂ｳ/・・尖劇・√′弡・ム・俯ｦｬ/蛻昜ｽ馴ｨ鍋┌隕・・・尖劇・√′・俯・/嶸ｸ・伜ｰ・嶸ｸ・倅ｸｭ/嶸ｸ・伜､・
		DRAWLINE
		FOR LOCAL, 1, FLAG:Cha・晧・ + 1
			LOCALS:1 += "/" + CSVCALLNAME(LOCAL, 0)
			PRINTBUTTON @"%"[" + CSVCALLNAME(LOCAL, 0) +"]", 24, LEFT%", CSVCALLNAME(LOCAL, 0)
			SIF LOCAL % 4 == 0
				PRINTL 
		NEXT
		SIF !LINEISEMPTY()
			PRINTL 
		DRAWLINE
		FOR LOCAL, 0 ,4
			LTEMPS = %AUTO_SPLIT("諤ｧ蛻･辟｡隕・・・尖劇・√′逕ｷ/・・尖劇・√′螂ｳ/・・尖劇・√′弡・ム・俯ｦｬ", "/", LOCAL)%
			SIF LTEMPS == LSEX_OPTION
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		SIF LFUTANARI_OPTION
			SETCOLOR 0x70C070
		PRINTBUTTON @"%"[・ｰ・川梵・ｼ ・懋ｻ瀧ｘ・・劇・・﨑罹共]", 24, LEFT%", "・ｰ・川梵・ｼ ・懋ｻ瀧ｘ・・劇・・﨑罹共"
		RESETCOLOR
		PRINTL 
		DRAWLINE
		FOR LOCAL, 0 ,2
			LTEMPS = %AUTO_SPLIT("蛻昜ｽ馴ｨ鍋┌隕・・・尖劇・√′・俯・", "/", LOCAL)%
			SIF GETBIT(LMAIDEN_OPTION, LOCAL)
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		PRINTL 
		FOR LOCAL, 0 ,3
			LTEMPS = %AUTO_SPLIT("嶸ｸ・伜ｰ・嶸ｸ・倅ｸｭ/嶸ｸ・伜､・, "/", LOCAL)%
			SIF LFAVOR_OPTION == LOCAL
				SETCOLOR 0x70C070
			PRINTBUTTON @"%"[" + LTEMPS + "]", 24, LEFT%", LTEMPS
			RESETCOLOR
		NEXT
		PRINTL 
		DRAWLINE
		PRINTBUTTON @"%"[・護符・ｨ・､]", 24, LEFT%", "END"
		PRINTL 
		CALL INPUT_SPLIT, LOCALS:1
		SIF RESULTS == "END"
			GOTO START
		IF GROUPMATCH(RESULTS, "諤ｧ蛻･辟｡隕・, "・・尖劇・√′逕ｷ", "・・尖劇・√′螂ｳ", "・・尖劇・√′弡・ム・俯ｦｬ")
			LSEX_OPTION = %RESULTS%
			GOTO START_CHARA
		ENDIF
		IF GROUPMATCH(RESULTS, "・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ", "蛻昜ｽ馴ｨ鍋┌隕・, "・・尖劇・√′・俯・", "嶸ｸ・伜ｰ・, "嶸ｸ・倅ｸｭ", "嶸ｸ・伜､・)
			SIF RESULTS == "・・川梵繧弟寇夋・俯ｦｬ縺ｫ縺吶ｋ"
				INVERTBIT LFUTANARI_OPTION, 0
			SIF RESULTS == "蛻昜ｽ馴ｨ鍋┌隕・
				INVERTBIT LMAIDEN_OPTION, 0
			SIF RESULTS == "・・尖劇・√′・俯・"
				INVERTBIT LMAIDEN_OPTION, 1
			SIF RESULTS == "嶸ｸ・伜ｰ・
				LFAVOR_OPTION = 0
			SIF RESULTS == "嶸ｸ・倅ｸｭ"
				LFAVOR_OPTION = 1
			SIF RESULTS == "嶸ｸ・伜､・
				LFAVOR_OPTION = 2
			GOTO START_CHARA
		ENDIF
		FOR LOCAL, 0, FLAG:Cha・晧・ + 1
			SIF RESULTS != CSVCALLNAME(LOCAL, 0)
				CONTINUE
			ADDCHARA LOCAL
			BREAK
		NEXT
		TARGET = CHARANUM - 1
		ADDVOIDCHARA
		MASTER = CHARANUM - 1
		SIF LSEX_OPTION == "・・尖劇・√′逕ｷ"
			TALENT:MASTER:・ｨ・・= 1
		SIF LSEX_OPTION == "・・尖劇・√′弡・ム・俯ｦｬ"
			TALENT:MASTER:弡・ム・俯ｦｬ = 1
		SIF LFUTANARI_OPTION
			TALENT:弡・ム・俯ｦｬ = 1
		SIF GETBIT(LMAIDEN_OPTION, 1)
			TALENT:MASTER:・俯・ = 1
		CFLAG:嶸ｸ・・= LFAVOR_OPTION * 1000
		DRAWLINE
		PRINTFORML 縲%CALLNAME:TARGET%
		;螟画焚繧貞・譛溷喧
		CALL SET_CRI_VAR
		FOR LOCAL:1, 0, 11
			;弴ｴ・昴ｒ縺ｯ縺倥￥
			;・ｬ・ｭ縺ｯ蜃ｦ逅・＠縺ｪ縺・
			SIF LOCAL:1 == 8 || LOCAL:1 == 9
				CONTINUE
			CALL SET_CRI_VAR, MENU(LOCAL:1), 1
		NEXT
		LINE = LINECOUNT
		DRAWLINE
		PRINTFORML 縲・罷俺 ・夋・
		DRAWLINE
		VARSET LVAR
		VARSET RESULT
		VARSET LSEX_CRI
		VARSET LMAIDEN_CRI
		IF LSEX_OPTION != "諤ｧ蛻･辟｡隕・
			CALL CHA_CRI_VAR, "諤ｧ蛻･"
			CALL ACT_MENU_SEX
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
		ENDIF
		IF !GETBIT(LMAIDEN_OPTION, 0)
			VARSET RESULT
			CALL CHA_CRI_VAR, "・・川梵縺護ｲ俯・"
			CALL ACT_MENU_MAIDEN_T
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
			VARSET RESULT
			CALL CHA_CRI_VAR, "・・尖劇・√′・俯・"
			CALL ACT_MENU_MAIDEN_M
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
		ENDIF
		CALL CHA_CRI_VAR, "邏雉ｪ"
		VARSET RESULT
		CALL ACT_MENU_TALENT_T
		CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
		FOR LOCAL:1, 0, 30
			LVAR:(LOCAL:1) += RESULT:(LOCAL:1) * 2
		NEXT
		CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
		FOR LOCAL:1, 0, 30
			LVAR:(LOCAL:1) += RESULT:(LOCAL:1)
		NEXT
		FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
			SETCOLOR 0xC07070
			PRINTFORM %UNICODE(0x25AE) * ABS(MIN(LVAR:(LOCAL:1), 0)),50,RIGHT%
			RESETCOLOR
			PRINTFORM  %MENU(LOCAL:1)%({LVAR:(LOCAL:1), 4}) 
			SETCOLOR 0x7070C0
			PRINTFORM %UNICODE(0x25AE) * MAX(LVAR:(LOCAL:1), 0),50,LEFT%
			PRINTFORML 
		NEXT
		WHILE LINECOUNT < LINE + LINENUM
			PRINTFORML 
		WEND
		RESETCOLOR
		LOCAL:3 = 0
		FOR LOCAL:1, 0, VARSIZE("TALENT")
			SIF !TALENT:(LOCAL:1)
				CONTINUE
			LTEMPS = 
			FOR LOCAL:2, 0, STRCOUNT(MENULIST(), "/") + 1
				IF LTALENT_MENU_CRI:(LOCAL:1):(LOCAL:2)
					SIF LTEMPS != ""
						LTEMPS += "/"
					LTEMPS += MENU(LOCAL:2) + "_" + TOSTR(LTALENT_MENU_CRI:(LOCAL:1):(LOCAL:2))
				ENDIF
			NEXT
			IF LTEMPS != ""
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %TALENTNAME:(LOCAL:1), 16, LEFT%
				SPLIT LTEMPS, "/", LOCALS
				FOR LOCAL:2, 0, RESULT
					LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
		NEXT
		IF MATCH(LMAIDEN_CRI, 0) != VARSIZE("LMAIDEN_CRI")
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %"蛻昜ｽ馴ｨ畷ｳｴ・・, 16, LEFT%
			FOR LOCAL:2, 0, 30
				SIF !LMAIDEN_CRI:(LOCAL:2)
					CONTINUE
				LTEMP = LMAIDEN_CRI:(LOCAL:2)
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%MENU(LOCAL:2)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		ENDIF
		IF MATCH(LSEX_CRI, 0) != VARSIZE("LSEX_CRI")
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %"諤ｧ蛻･・ｴ・・, 16, LEFT%
			FOR LOCAL:2, 0, 30
				SIF !LSEX_CRI:(LOCAL:2)
					CONTINUE
				LTEMP = LSEX_CRI:(LOCAL:2)
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%MENU(LOCAL:2)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		ENDIF
		LOCAL:3 = 0
		FOR LOCAL:1, 0, STRCOUNT(MENULIST(), "/") + 1
			LTEMPS = 
			FOR LOCAL:2, 0, VARSIZE("TALENT")
				SIF !TALENT:(LOCAL:2)
					CONTINUE
				LTEMP = LTALENT_MENU_CRI:(LOCAL:2):(LOCAL:1)
				SIF !LTEMP
					CONTINUE
				LTEMPS += "/" + TALENTNAME:(LOCAL:2) + "_" + TOSTR(LTEMP)
			NEXT
			SIF LMAIDEN_CRI:(LOCAL:1)
				LTEMPS += "/" + "蛻昜ｽ馴ｨ畷ｳｴ・・ + "_" + TOSTR(LMAIDEN_CRI:(LOCAL:1))
			SIF LSEX_CRI:(LOCAL:1)
				LTEMPS += "/" + "諤ｧ蛻･・ｴ・・ + "_" + TOSTR(LSEX_CRI:(LOCAL:1))
			SIF LTEMPS == ""
				CONTINUE
			SIF LOCAL:3++ == 0
				DRAWLINE
			PRINTFORM %MENU(LOCAL:1), 16, LEFT%
			SPLIT LTEMPS, "/", LOCALS
			FOR LOCAL:2, 1, RESULT
				LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
				SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
				PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
				RESETCOLOR
			NEXT
			PRINTL 
		NEXT
		WHILE LINECOUNT < LINE + LINENUM:1
			PRINTFORML 
		WEND
		WAIT
		FOR LOCAL, 0, STRCOUNT(MENULIST(), "/") + 1
			CALL RES_CRI_VAR, 1
			CALL ACT_M_INIT(LOCAL)
			VARSET LVAR
			VARSET LSEX_CRI
			VARSET LMAIDEN_CRI
			VARSET RESULT
			IF !GETBIT(LMAIDEN_OPTION, 0)
				CALL CHA_CRI_VAR, "・・尖劇・√′・俯・"
				TRYCCALLFORM ACT_ACTM{LOCAL}_MAIDEN_M
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
				CALL CHA_CRI_VAR, "・・川梵縺護ｲ俯・"
				TRYCCALLFORM ACT_ACTM{LOCAL}_MAIDEN_T
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LMAIDEN_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
			ENDIF
			IF LSEX_OPTION != "諤ｧ蛻･辟｡隕・
				CALL CHA_CRI_VAR, "諤ｧ蛻･"
				TRYCCALLFORM ACT_ACTM{LOCAL}_GENDER_T
					CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
					FOR LOCAL:1, 0, 30
						LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1) * 2
					NEXT
					CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
					FOR LOCAL:1, 0, 30
						LSEX_CRI:(LOCAL:1) += RESULT:(LOCAL:1)
					NEXT
				CATCH
				ENDCATCH
			ENDIF
			CALL CHA_CRI_VAR, "邏雉ｪ"
			TRYCCALLFORM ACT_ACTM{LOCAL}_TALENT_T
			CATCH
			ENDCATCH
			CALLF VARIABLE_OF_CRI, "GET", "蝗ｺ螳夂ｴｯ險・
			FOR LOCAL:1, 0, 30
				LVAR:(LOCAL:1) += RESULT:(LOCAL:1) * 2
			NEXT
			CALLF VARIABLE_OF_CRI, "GET", "螟牙虚邏ｯ險・
			FOR LOCAL:1, 0, 30
				LVAR:(LOCAL:1) += RESULT:(LOCAL:1)
			NEXT
			LINE = LINECOUNT
			DRAWLINE
			PRINTFORML 縲%MENU(LOCAL)%
			DRAWLINE
			FOR LOCAL:1, 0, ACTM_NUM(LOCAL)
				SETCOLOR 0xC07070
				PRINTFORM %UNICODE(0x25AE) * ABS(MIN(LVAR:(LOCAL:1), 0)),50,RIGHT%
				RESETCOLOR
				PRINTFORM  %GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:1))%({LVAR:(LOCAL:1), 4}) 
				SETCOLOR 0x7070C0
				PRINTFORM %UNICODE(0x25AE) * MAX(LVAR:(LOCAL:1), 0),50,LEFT%
				PRINTFORML 
			NEXT
			WHILE LINECOUNT < LINE + LINENUM
				PRINTFORML 
			WEND
			RESETCOLOR
			LOCAL:3 = 0
			FOR LOCAL:1, 0, VARSIZE("TALENT")
				SIF !TALENT:(LOCAL:1)
					CONTINUE
				LTEMPS = 
				FOR LOCAL:2, 0, ACTM_NUM(LOCAL)
					IF LTALENT_CRI:(LOCAL:1):LOCAL:(LOCAL:2)
						SIF LTEMPS != ""
							LTEMPS += "/"
						LTEMPS += GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2)) + "_" + TOSTR(LTALENT_CRI:(LOCAL:1):LOCAL:(LOCAL:2))
					ENDIF
				NEXT
				IF LTEMPS != ""
					SIF LOCAL:3++ == 0
						DRAWLINE
					PRINTFORM %TALENTNAME:(LOCAL:1), 16, LEFT%
					SPLIT LTEMPS, "/", LOCALS
					FOR LOCAL:2, 0, RESULT
						LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
						SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
						PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
						RESETCOLOR
					NEXT
					PRINTL 
				ENDIF
			NEXT
			IF MATCH(LMAIDEN_CRI, 0) != VARSIZE("LMAIDEN_CRI")
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %"蛻昜ｽ馴ｨ畷ｳｴ・・, 16, LEFT%
				FOR LOCAL:2, 0, 30
					SIF !LMAIDEN_CRI:(LOCAL:2)
						CONTINUE
					LTEMP = LMAIDEN_CRI:(LOCAL:2)
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2))% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
			IF MATCH(LSEX_CRI, 0) != VARSIZE("LSEX_CRI")
				SIF LOCAL:3++ == 0
					DRAWLINE
				PRINTFORM %"諤ｧ蛻･・ｴ・・, 16, LEFT%
				FOR LOCAL:2, 0, 30
					SIF !LSEX_CRI:(LOCAL:2)
						CONTINUE
					LTEMP = LSEX_CRI:(LOCAL:2)
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:2))% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			ENDIF
			DRAWLINE
			FOR LOCAL:1, 0, ACTM_NUM(LOCAL)
				LTEMPS = 
				FOR LOCAL:2, 0, VARSIZE("TALENT")
					SIF !TALENT:(LOCAL:2)
						CONTINUE
					LTEMP = LTALENT_CRI:(LOCAL:2):LOCAL:(LOCAL:1)
					SIF !LTEMP
						CONTINUE
					LTEMPS += "/" + TALENTNAME:(LOCAL:2) + "_" + TOSTR(LTEMP)
				NEXT
				SIF LMAIDEN_CRI:(LOCAL:1)
					LTEMPS += "/" + "蛻昜ｽ馴ｨ畷ｳｴ・・ + "_" + TOSTR(LMAIDEN_CRI:(LOCAL:1))
				SIF LSEX_CRI:(LOCAL:1)
					LTEMPS += "/" + "諤ｧ蛻･・ｴ・・ + "_" + TOSTR(LSEX_CRI:(LOCAL:1))
				SIF LTEMPS == ""
					CONTINUE
				PRINTFORM %GET_ACTABBNAME(ACTM_NUM(LOCAL, LOCAL:1)), 16, LEFT%
				SPLIT LTEMPS, "/", LOCALS
				FOR LOCAL:2, 1, RESULT
					LTEMP = TOINT(AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 1))
					SETCOLOR LTEMP > 0 ? 0x7070C0 # 0xC07070
					PRINTFORM <%AUTO_SPLIT(LOCALS:(LOCAL:2), "_", 0)% \@ LTEMP > 0 ? + # -\@{ABS(LTEMP)}> 
					RESETCOLOR
				NEXT
				PRINTL 
			NEXT
			WHILE LINECOUNT < LINE + LINENUM:1
				PRINTFORML 
			WEND
			WAIT
		NEXT
		WHILE CHARANUM > LCHARANUM
			DELCHARA CHARANUM -  1
		WEND
		GOTO START_CHARA
	CASE "邨ゆｺ・
		TARGET = LTARGET
		MASTER = LMASTER
		WHILE CHARANUM > LCHARANUM
			DELCHARA CHARANUM -  1
		WEND
		RETURN 1
ENDSELECT
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;・ｸ・ｴ・後う繝ｳ繝輔か		竊担YSTEM_DATAMENU.ERB縺ｫ縺ｦ莉｣譖ｿ
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;@SAVEINFO
;PUTFORM {DAY+1}譌･逶ｮ%GET_TIME()% \@ TARGET >= 0 ? %CALLNAME:TARGET%縺・CALLNAME:MASTER%繧廷｡ｰ・川､・# \@


;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
;繝舌・繧ｸ繝ｧ繝ｳ繧｢繝・・
;笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏笏
@VERSION_UP

>>>>>>> d29239f180aad384a1e39d65cf6a8a750783a09d
